PROGRAM SINGMULT1;
  CONST
    BL = ' '; BL2 = '  ';
    DUMMY = '';
    MAXPART_N = 80;
    MAXPART_V = 40;
    NE = ' ';

    MAXT6T6 = 188;
    ASPECT_PAIRS : ARRAY [1..MAXT6T6, 1..3] OF STRING [8] =
(*01*)(('',     '',       '1'),   (*  *)           
(*02*) ('',     '',      '1'),   (*  *)            
(*03*) ('',     '',      '1'),   (*  *)            
(*04*) ('',     '',    '0'),   (*  *)           
(*05*) ('',     '',    '0'),   (*  *)             
(*06*) ('',     '',    '0'),   (*  *)             
(*07*) ('',     '',     '1'),   (*  *)         
(*08*) ('',     '',    '0'),   (*  *)         
(*09*) ('',     '',      '1'),   (*  *)         
(*10*) ('',     '',    '0'),   (*  *)         
(*11*) ('','',    '1'),   (*  *)    
(*12*) ('','',   '1'),   (*  *)       
(*13*) ('','',   '1'),   (*  *)        
(*14*) ('','',    '1'),   (*  *)     
(*15*) ('','',    '1'),   (*  *)        
(*16*) ('','',   '1'),   (*  *)        
(*17*) ('',   '',    '1'),   (*  *)           
(*18*) ('', '',    '1'),   (*  *)        
(*19*) ('', '',   '1'),   (*  *)        
(*20*) ('', '',    '1'),   (*  *)        
(*21*) ('','',   '1'),   (*  *)        
(*22*) ('', '',    '1'),   (*  *)        
(*23*) ('', '',     '1'),   (*  *)        
(*24*) ('', '',    '1'),   (*  *)        
(*25*) ('', '',    '1'),   (*  *)      
(*26*) ('', '',    '1'),   (*  *)       
(*27*) ('','',   '1'),   (*  *)       
(*28*) ('',  '',     '1'),   (*  *)       
(*29*) ('',  '',     '1'),   (*  *)         
(*30*) ('', '',    '1'),   (*  *)       
(*31*) ('','',  '1'),   (*  *)      
(*32*) ('','',  '1'),   (*  *)       
(*33*) ('','' ,  '1'),   (*  *)         
(*34*) ('', '',    '1'),   (*  *)         
(*35*) ('','',   '1'),   (*  *)       
(*36*) ('','',  '1'),   (*  *)       
(*37*) ('','',   '1'),   (*  *)        
(*38*) ('','',   '1'),   (*  *)        
(*39*) ('', '',    '1'),   (*  *)         
(*40*) ('','','1'),   (*  *)      
(*41*) ('', '',   '1'),   (*  *)         
(*42*) ('', '',    '1'),   (*  *)         
(*43*) ('', '',    '1'),   (*  *)        
(*44*) ('', '',    '1'),   (*  *)        
(*45*) ('','',   '1'),   (*  *)         
(*46*) ('','',    '1'),   (*  *)        
(*47*) ('','',   '1'),   (*  *)         
(*48*) ('', '',    '1'),   (*  *)         
(*49*) ('','',  '1'),   (*  *)       
(*50*) ('', '',    '1'),   (*  *)       
(*51*) ('','',  '1'),   (*  *)       
(*52*) ('','',  '1'),   (*  *)        
(*53*) ('', '',   '1'),   (*  *)       
(*54*) ('', '',    '1'),   (*  *)       
(*55*) ('',   '',   '1'),   (*  *)     
(*56*) ('','',   '1'),   (*  *)     
(*57*) ('','',   '1'),   (*  *)     
(*58*) ('', '',    '1'),   (*  *)       
(*59*) ('', '',    '1'),   (*  *)        
(*60*) ('','',   '1'),   (*  *)        
(*61*) ('', '',    '1'),   (*  *)          
(*62*) ('', '',   '1'),   (*  *)       
(*63*) ('', '',    '1'),   (*  *)       
(*64*) ('', '',    '1'),   (*  *)       
(*65*) ('', '',    '1'),   (*  *)         
(*66*) ('', '',    '1'),   (*  *)         
(*67*) ('', '',    '1'),   (*  *)        
(*68*) ('', '',    '1'),   (*  *)         
(*69*) ('', '',   '1'),   (*  *)       
(*70*) ('',  '',   '1'),   (*  *)          
(*71*) ('', '',   '0'),   (*  *)            
(*72*) ('',   '',    '1'),   (*  *)              
(*73*) ('',    '',       '1'),   (* /// *)
(*74*) ('',    '',     '1'),   (*  *)            
(*75*) ('',    '',    '0'),   (*  *)            
(*76*) ('',    '',      '1'),   (*  *)           
(*77*) ('',  '',   '1'),   (*  *)          
(*78*) ('',    '',     '1'),   (*  *)        
(*79*) ('',    '',     '1'),   (*  *)            
(*80*) ('',  '',   '1'),   (*  *)           
(*81*) ('',  '',     '1'),   (*  *)        
(*82*) ('',  '',   '1'),   (*  *)            
(*83*) ('',    '',    '0'),   (*  *)             
(*84*) ('',    '',     '1'),   (*  *)             
(*85*) ('',    '',      '1'),   (*  *)           
(*86*) ('',    '',     '0'),   (*  *)            
(*87*) ('',    '',   '0'),   (*  *)           
(*88*) ('',    '',     '1'),   (*  *)            
(*89*) ('',    '',     '0'),   (*  *)           
(*90*) ('',    '',    '0'),   (*  *)            
(*91*) ('',    '',   '0'),   (*  *)         
(*92*) ('',  '',   '1'),   (*  *)          
(*93*) ('',  '',     '1'),   (*  *)        
(*94*) ('',  '',      '1'),   (*  *)        
(*95*) ('',     '',     '1'),   (*  *)           
(*96*) ('',     '',    '0'),   (*  *)         
(*97*) ('',   '',      '1'),   (*  *)         
(*98*) ('',   '',    '1'),   (*  *)            
(*99*) ('',   '',  '0'),   (*  *)         
(*100*)('',   '',    '1'),   (*  *)            
(*101*)('',   '',    '0'),   (*  *)         
(*102*)('',   '',    '0'),   (*  *)           
(*103*)('',  '','0'),   (*  *)            
(*104*)('',  '','0'),   (*  *)           
(*105*)('',    '',    '0'),   (*  *)            
(*106*)('',    '',  '0'),   (*  *)             
(*107*)('',   '',    '1'),   (*  *)             
(*108*)('',    '',     '1'),   (*  *)         
(*109*)('',   '',    '1'),   (*  *)       
(*110*)('',  '',     '1'),   (*  *)           
(*111*)('',  '',   '1'),   (*  *)           
(*112*)('',  '',   '1'),   (*  *)           
(*113*)('',  '',   '1'),   (*  *)          
(*114*)('',   '',     '1'),   (*  *)          
(*115*)('', '','0'),  (*  *)          
(*116*)('', '',  '0'),   (*  *)          
(*117*)('','', '0'),   (*  *)          
(*118*)('',     '',   '0'),   (*  *)           
(*119*)('',     '',     '0'),   (*  *)         
(*120*)('',     '',     '1'),   (*  *)          
(*121*)('',     '',    '0'),   (*  *)         
(*122*)('',     '',    '1'),   (*  *)         
(*123*)('',     '',    '0'),   (*  *)         
(*124*)('',     '',      '0'),   (*  *)          
(*125*)('',   '',     '1'),   (*  *)           
(*126*)('',   '',     '1'),   (*  *) 
(*127*)('',   '',    '1'),   (*  *) 
(*128*)('',   '',      '1'),   (*  *)           
(*129*)('',  '',  '1'),   (*  *)             
(*130*)('',   '',     '1'),   (*  *)           
(*131*)('',   '',      '1'),   (*  *)           
(*132*)('',   '',      '1'),   (*  *)          
(*133*)('',   '',     '1'),   (*  *)         
(*134*)('',   '',     '1'),   (*  *)         
(*135*)('',   '',      '1'),   (*  *)            
(*136*)('',   '',     '1'),   (*  *)         
(*137*)('',   '',    '1'),   (*  *)           
(*138*)('',   '',   '1'),   (*  *)            
(*139*)('',   '',     '1'),   (*  *)          
(*140*)('',   '',     '1'),   (*  *)          
(*141*)('',   '',     '1'),   (*  *)            
(*142*)('',    '',     '1'),   (*  *)          
(*143*)('',    '',     '1'),   (*  *)          
(*144*)('',  '',     '1'),   (*  *)        
(*145*)('','',  '1'),   (*  *)         
(*146*)('',  '', '1'),   (*  *)             
(*147*)('',   '',     '0'),   (*  *)           
(*148*)('',   '',     '0'),   (*  *)           
(*149*)('',   '',    '0'),   (*  *)             
(*150*)('','', '1'),   (*  *)        
(*151*)('',    '',    '0'),   (*  *)            
(*152*)('',  '',     '1'),   (*  *)             
(*153*)('',  '',  '1'),   (*  *)             
(*154*)('',  '',   '1'),   (*  *)             
(*155*)('',  '',  '1'),   (*  *)            
(*156*)('',    '',    '0'),   (*  *)           
(*157*)('',    '',       '0'),   (*  *)           
(*158*)('',    '',     '0'),   (*  *)           
(*159*)('',    '',     '0'),   (*  *)           
(*16-*)('',    '',     '0'),   (*  *)           
(*161*)('',    '',   '0'),   (*  *)          
(*162*)('',    '',    '0'),   (*  *)         
(*163*)('',    '',    '0'),   (*  *)         
(*164*)('',    '',      '0'),   (*  *)
(*165*)('',    '',    '0'),   (*  *)
(*166*)('',     '',    '1'),   (*  *)             
(*167*)('',   '',    '1'),   (*  *)             
(*168*)('', '',    '1'),   (*  *)             
(*169*)('',  '',   '0'),   (*  *)           
(*170*)('',  '',   '0'),   (*  *)            
(*171*)('',  '',   '0'),   (*  *)           
(*172*)('', '',  '0'),   (*  *)           
(*173*)('', '',   '0'),   (*  *)           
(*174*)('',  '',    '0'),   (*  *)           
(*175*)('','',   '0'),   (*  *)           
(*176*)('',    '',     '0'),   (*  *)         
(*177*)('',    '',   '0'),   (*  *)           
(*178*)('', '',     '1'),   (*  *)       
(*179*)('',   '',    '0'),   (*  *)       
(*180*)('',   '',     '0'),   (*  *)           
(*181*)('',   '',   '0'),   (*  *)         
(*182*)('',    '',   '0'),   (*  *)           
(*183*)('',    '',     '0'),   (*  *)           
(*184*)('',    '',   '0'),   (*  *)           
(*185*)('',    '',     '0'),   (*  *)           
(*186*)('',     '',    '0'),   (*  *)
(*187*)('',    '',    '0'),   (*  *)             
(*188*)('',   '',      '0'));  (*  *)
    MAXT6TI = 37;
    ASPECT_PAIRS2 : ARRAY [1..MAXT6TI, 1..3] OF STRING [9] =
(*01*)(('',  '',    '1'), (*  *)
(*02*) ('','',    '1'), (*  *)
(*03*) ('',  '',     '1'), (*  *)
(*04*) ('','',     '1'), (*  *)
(*05*) ('',      '',       '1'), (*  *)
(*06*) ('',      '',      '1'), (* / *)
(*07*) ('',    '',     '1'), (*  *)
(*08*) ('',    '',    '1'), (*  *)
(*09*) ('',     '',     '1'), (*  *)
(*10*) ('',   '',   '1'), (*  *)
(*11*) ('',     '',      '1'), (* / *)
(*12*) ('',   '',    '1'), (* *)
(*13*) ('',     '',     '1'), (*  *)
(*14*) ('',   '',   '1'), (*  *)
(*15*) ('',     '',   '0'), (*  *)
(*16*) ('',     '',   '0'), (*  *)
(*17*) ('',     '',   '0'), (*  *)
(*18*) ('',   '', '0'), (*  *)
(*19*) ('',   '', '0'), (*  *)
(*20*) ('',      '',   '0'), (*  *)
(*21*) ('',      '', '0'), (*  *)
(*22*) ('',    '', '0'), (*  *)
(*23*) ('',    '','0'), (*  *)
(*24*) ('',    '', '0'), (*  *)
(*25*) ('',  '','0'),(*  *)
(*26*) ('',      '',  '0'), (*  *)
(*27*) ('',    '','0'), (*  *)
(*28*) ('',     '',      '1'), (*  *)
(*29*) ('',   '',    '1'), (*  *)
(*30*) ('', '', '1'), (*  *)
(*31*) ('', '',      '1'), (*  *)
(*32*) ('',     '',  '0'), (*  *)
(*33*) ('',   '','0'), (*  *)
(*34*) ('',      '',    '0'), (*  *)
(*35*) ('',      '',  '0'), (*  *)
(*36*) ('',    '',  '0'), (*  *)
(*37*) ('',     '',   '0'));(*  *)


    MAXPREF = 40;
    AS_PRS : ARRAY [1..MAXPREF] OF STRING [4] =
('','','','','',
'','','','','',
'','','','','','',
'','','',
'','','','','','',
'','','','','','','',
'','','','',
'','','','');

  TYPE
    STATUS = (ZERO, SUB, VERB, ADJ, ADV);
    STR2 = STRING [2];
    STR3 = STRING [3];
    STR115 = STRING [115];
    REF = ^NODE;
    NODE =
      RECORD
        KEY : STR115;
        LEFT, RIGHT : REF;
      END;

  VAR
    N_AMT, V_AMT : INTEGER; 
    I, P, L, CLASS : INTEGER;
    PAIRAMT_V, PAIRAMT_N, COUNT, NCNT : INTEGER;
    INP, OUT, OUTN, OUTV : TEXT;
    INIT, FIN : STR2;
    CURSTAT : STATUS;
    LINE, TAIL, TOKEN : STR115;
    ROOT : REF;
    BORDER, TO_REVERSE : BOOLEAN;

    NOUNS : ARRAY [1..MAXPART_N] OF
      RECORD
        LIN : STR115;
        TKN : STR115;
      END;
    VERBS : ARRAY [1..MAXPART_V] OF
      RECORD
        LIN : STR115;
        TKN : STR115;
      END;


  (* NOTE: Recursive procedures should not pass parameters by value (takes
   *       too much stack), and if the procedure receives parameters by 
   *       reference (var), it cannot be called with an expression. To 
   *       keep the current way of calling this proc, I added var to the
   *       parameter of DO_ALLOC_IN_TREE (and renamed it) and added a buffer
   *       function, see below ALLOC_IN_TREE. AFG
   *)

  PROCEDURE DO_ALLOC_IN_TREE (VAR TOKEN : STR115;
          (*=============*)VAR CURROOT : REF);
    VAR
      NEWNODE : REF;
  BEGIN
    IF CURROOT = NIL
      THEN
        BEGIN
          NEW (NEWNODE);
          WITH NEWNODE^ DO
            BEGIN
              KEY := TOKEN;
              LEFT := NIL;
              RIGHT := NIL;
            END;
          CURROOT := NEWNODE;
        END
      ELSE WITH CURROOT^ DO
        IF TOKEN <> KEY
          THEN
            IF TOKEN < KEY
              THEN DO_ALLOC_IN_TREE (TOKEN, LEFT)
              ELSE DO_ALLOC_IN_TREE (TOKEN, RIGHT);
  END;

  PROCEDURE ALLOC_IN_TREE (TOKEN : STR115;
          (*=============*)VAR CURROOT : REF);
  begin
    do_alloc_in_tree (token, curroot);
  end;

  PROCEDURE PRINT_TREE (T : REF);
          (*==========*)
  BEGIN
    IF T <> NIL
      THEN WITH T^ DO
        BEGIN
          PRINT_TREE (LEFT);
          WRITELN (OUT, KEY);
          INC (COUNT);
          IF (KEY [1] = '2') AND NOT BORDER
            THEN
              BEGIN
                NCNT := COUNT - 1;
                BORDER := TRUE;
              END;
          PRINT_TREE (RIGHT);
        END;
  END;

  PROCEDURE INIT_NOUNS;
         (*===========*)
    VAR
      I : INTEGER;
  BEGIN
    FOR I := 1 TO MAXPART_N DO
      WITH NOUNS [I] DO
        BEGIN
          LIN := DUMMY;
          TKN := DUMMY;
      END;
  END;


  PROCEDURE INIT_VERBS;
         (*===========*)
    VAR
      I : INTEGER;
  BEGIN
    FOR I := 1 TO MAXPART_V DO
      WITH VERBS [I] DO
        BEGIN
          LIN := DUMMY;
          TKN := DUMMY;
      END;
  END;


  FUNCTION ISADJ (TOKEN : STR115) : BOOLEAN;
         (*=====*)
    CONST
      ADJFIN : ARRAY [1..13] OF STRING [4] =
        ('','','','','','','',
        '','','','','','');
    VAR
      I, L, L1 : INTEGER;
      FOUND :  BOOLEAN;

  BEGIN
    L := LENGTH (TOKEN);
    FOUND := FALSE;
    I := 0;
    REPEAT
      INC (I);
      L1 := LENGTH (ADJFIN [I]);
      FOUND := (ADJFIN [I] = COPY (TOKEN, L-L1+1, L1));
    UNTIL FOUND OR (I = 13);
    ISADJ := FOUND;
  END;


  FUNCTION ISGEN (TOKEN : STR115) : BOOLEAN;
         (*=====*)
    CONST
      GENFIN : ARRAY [1..12] OF STR2 =
        ('','','','','','','','','','','','');
    VAR
      I, L, L1 : INTEGER;
      FOUND :  BOOLEAN;

  BEGIN
    L := LENGTH (TOKEN);
    FOUND := FALSE;
    I := 0;
    REPEAT
      INC (I);
      L1 := LENGTH (GENFIN [I]);
      FOUND := (GENFIN [I] = COPY (TOKEN, L-L1+1, L1));
    UNTIL FOUND OR (I = 12);
    ISGEN := FOUND
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '^') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '') AND (TOKEN <> '')
      AND (TOKEN <> '');
  END;


  PROCEDURE SPLIT_NOUN (TOK_IN : STR115;
          (*==========*)VAR TOK_OUT : STR115);
    VAR
      P : INTEGER;
      TOK1, TOK2 : STR115;

  BEGIN
    P := POS ('1', TOK_IN) + POS ('2', TOK_IN) + POS ('3', TOK_IN)
      + POS ('4', TOK_IN) + POS ('5', TOK_IN) + POS ('6', TOK_IN);
    IF P > 0
      THEN TOK_OUT := COPY (TOK_IN, 1, P - 1)
      ELSE TOK_OUT := TOK_IN;

    P := POS (BL, TOK_OUT);
    IF P > 0
      THEN
        BEGIN
          TOK1 := COPY (TOK_OUT, 1, P - 1);
          TOK2 := COPY (TOK_OUT, P + 1, LENGTH (TOK_OUT) - P);
          IF NOT ISADJ (TOK1) OR ISGEN (TOK2)
            THEN TOK_OUT := TOK1
            ELSE TOK_OUT := TOK2;
        END;
  END;

FUNCTION REVERSABLE_0 (NUM : INTEGER) : BOOLEAN;
       (*============*)
CONST
  REVERS0 : ARRAY [1..13] OF INTEGER =
    (2,3,6,7,9,15,16,17,18,19,20,21,22);
VAR 
  I : INTEGER; 
  FOUND : BOOLEAN;
BEGIN
  FOUND := FALSE;
  I := 0;
  REPEAT 
    INC(I); 
    FOUND := (NUM = REVERS0[I]);
  UNTIL FOUND OR (I = 13);
  REVERSABLE_0 := FOUND;
END;

FUNCTION REVERSABLE_1 (NUM : INTEGER) : BOOLEAN;
       (*============*)
CONST
  REVERS1 : ARRAY [1..9] OF INTEGER =
    (6,7,8,10,12,17,20,24,25);
VAR 
  I : INTEGER; 
  FOUND : BOOLEAN;
BEGIN
  FOUND := FALSE;
  I := 0;
  REPEAT 
    INC(I); 
    FOUND := (NUM = REVERS1[I]);
  UNTIL FOUND OR (I = 9);
  REVERSABLE_1 := FOUND;
END;

  PROCEDURE MAKE_PAIRS_N;
          (*============*)

    CONST

{ List of SINGL-PLUR endings of the same length }
    MAX0 = 28;
    NUMB_PAIRS0 : ARRAY [1..MAX0, 1..2] OF STR3 =
(*01*)(('',     ''),     (*  *)
(*02*) ('',     ''),     (*  *)
(*03*) ('',     ''),     (*  *)
(*04*) ('',     ''),     (*  *)
(*05*) ('',    ''),    (*  *)
(*06*) ('',    ''),    (*  *)
(*07*) ('',    ''),    (*  *)
(*08*) ('',     ''),     (*  *)
(*09*) ('',     ''),     (*  *)
(*10*) ('',    ''),    (*  *)
(*11*) ('',    ''),    (*  *)
(*12*) ('',    ''),    (*  *)
(*13*) ('',    ''),    (*  *)
(*14*) ('',    ''),    (*  *)
(*15*) ('',     ''),     (*  *)
(*16*) ('',     ''),     (*  *)
(*17*) ('',     ''),     (*  *)
(*18*) ('',     ''),     (*  *)
(*19*) ('',   ''),   (*  *)
(*20*) ('',    ''),    (*  *)
(*21*) ('',    ''),    (*  *)
(*22*) ('',    ''),    (*  *)
(*23*) ('',    ''),    (*  *)
(*24*) ('',    ''),    (*  *)
(*25*) ('',    ''),    (*  *)
(*26*) ('',    ''),    (*  *)
(*27*) ('',    ''),    (*  *)
(*28*) ('',     ''));    (*  *)

{ List of SINGL-PLUR endings of different lengths }
  MAX1 = 27;
  NUMB_PAIRS1 : ARRAY [1..MAX1, 1..2] OF STRING [4] =
(*01*)(('',      ''),     (*  *)
(*02*) ('',      ''),     (*  *)
(*03*) ('',      ''),  (*  *)
(*04*) ('',      ''),     (*  *)
(*05*) ('',      ''),    (*  *)
(*06*) ('',     ''),    (*  *)
(*07*) ('',     ''),    (*  *)
(*08*) ('',   ''),  (*  *)
(*09*) ('',     ''),   (*  *)
(*10*) ('',     ''),    (*  *)
(*11*) ('',    ''),   (*  *)
(*12*) ('',   ''),    (*  *)
(*13*) ('',    ''),   (*  *)
(*14*) ('',    ''),   (*  *)
(*15*) ('',    ''),   (*  *)
(*16*) ('',    ''),   (*  *)
(*17*) ('',   ''),     (*  *)
(*18*) ('',  ''),   (*  *)
(*19*) ('',   ''),    (*  *)
(*20*) ('',   ''),     (*  *)
(*21*) ('',    ''),   (*  *)
(*22*) ('',    ''),   (*  *)
(*23*) ('',    ''),     (*  *)
(*24*) ('',   ''),    (*  *)
(*25*) ('',    ''),   (*  *)
(*26*) ('',     ''),    (*  *)
(*27*) ('',   ''));   (*  *)

    VAR
      I, J, K, LI, LJ : INTEGER;
      FOUND : BOOLEAN;
      TMP_LIN : STR115;
      TMP_TKN, STEM : STR115;

  BEGIN
    FOR I := 1 TO N_AMT DO
      WITH NOUNS [I] DO
        SPLIT_NOUN (LIN, TKN);

    FOR I := 1 TO N_AMT DO
      FOR J := I + 1 TO N_AMT DO
        IF NOUNS [I].TKN > NOUNS [J].TKN
          THEN
            BEGIN
              TMP_LIN := NOUNS [I].LIN;
              TMP_TKN := NOUNS [I].TKN;
              NOUNS [I].LIN := NOUNS [J].LIN;
              NOUNS [I].TKN := NOUNS [J].TKN;
              NOUNS [J].LIN := TMP_LIN;
              NOUNS [J].TKN := TMP_TKN;
            END;
    FOR I := 1 TO N_AMT DO
      FOR J := I + 1 TO N_AMT DO
        BEGIN
          FOUND := FALSE;
          LI := LENGTH (NOUNS [I].TKN);
          LJ := LENGTH (NOUNS [J].TKN);
          TO_REVERSE := FALSE;
          CASE ABS (LI - LJ) OF
            0 :
              BEGIN
                K := 0;
                REPEAT
                  INC (K);
                  TMP_TKN := COPY (NOUNS [I].TKN, 1,
                    LI - LENGTH (NUMB_PAIRS0 [K, 1])) + NUMB_PAIRS0 [K, 2];
                  FOUND := (COPY (NOUNS [I].TKN,
                    LI - LENGTH (NUMB_PAIRS0 [K, 1]) + 1,
                    LENGTH (NUMB_PAIRS0 [K, 1])) = NUMB_PAIRS0 [K, 1])
                    AND (TMP_TKN = NOUNS [J].TKN);
                UNTIL FOUND OR (K = MAX0);
                TO_REVERSE := REVERSABLE_0 (K);
              END;
            1..4 :
              BEGIN
                FOUND := (NOUNS [I].TKN = '') AND
                  (NOUNS [J].TKN = '')
                  OR (NOUNS [I].TKN = ' ') AND
                  (NOUNS [J].TKN = ' ')
                  OR (NOUNS [I].TKN = ' ') AND
                  (NOUNS [J].TKN = ' ')
                  OR (NOUNS [I].TKN = ' ') AND
                  (NOUNS [J].TKN = ' ');
                IF NOT FOUND
                  THEN
                    BEGIN
                      K := 0;
                      REPEAT
                        INC (K);
                        TMP_TKN := COPY (NOUNS [I].TKN, 1,
                          LI - LENGTH (NUMB_PAIRS1 [K, 1])) +
                          NUMB_PAIRS1 [K, 2];
                        FOUND :=
                          (COPY (NOUNS [I].TKN,
                          LI - LENGTH (NUMB_PAIRS1 [K, 1]) + 1,
                          LENGTH (NUMB_PAIRS1 [K, 1])) = NUMB_PAIRS1 [K, 1])
                          AND (TMP_TKN = NOUNS [J].TKN)
                          AND ((K > 1) OR (NOUNS [I].TKN [LI] <> ''));
                      UNTIL FOUND OR (K = MAX1);
                    END;
                FOUND := FOUND                
                  AND NOT ((NOUNS [I].TKN = '') 
                  AND (NOUNS [J].TKN = ''))
                  AND NOT ((NOUNS [I].TKN = '') 
                  AND (NOUNS [J].TKN = ''))
                  AND NOT ((COPY(NOUNS [I].TKN, 
                    LENGTH(NOUNS [I].TKN)-1, 2) = '') 
                  AND (NOUNS [J].TKN = NOUNS [I].TKN+''));
                TO_REVERSE := REVERSABLE_1 (K);
              END;
          END;

          STEM := COPY (NOUNS [I].LIN, 1, LENGTH (NOUNS [I].LIN) - 3);

          IF  (FOUND AND 
            (ABS (LENGTH (NOUNS [I].LIN) - LENGTH (NOUNS [J].LIN)) <= 4))
            AND NOT
            ((COPY (NOUNS [J].LIN, LENGTH (NOUNS [J].LIN) - 2, 3) = '')
            AND (COPY (NOUNS [I].LIN, LENGTH (NOUNS [I].LIN) - 2, 3) = '')
            AND (STEM <> '') AND (STEM <> '') AND (STEM <> '')
            AND (STEM <> '')  AND (STEM <> ''))

            OR ((NOUNS [J].LIN = ' ') AND
            (NOUNS [I].LIN = ' ')) 
            THEN
              BEGIN
                IF TO_REVERSE
                  THEN ALLOC_IN_TREE ('1 ' + NOUNS [J].LIN + 
                    BL2 + NOUNS [I].LIN, ROOT)
                  ELSE ALLOC_IN_TREE ('1 ' + NOUNS [I].LIN + 
                    BL2 + NOUNS [J].LIN, ROOT);
                INC (PAIRAMT_N);
              END;
        END;
    N_AMT := 0;
    INIT_NOUNS;
  END;


  PROCEDURE SPLIT_VERB (TOK_IN : STR115;
          (*==========*)VAR TOK_OUT : STR115);
    VAR
      P, L : INTEGER;
      NEGAT : BOOLEAN;

  BEGIN
    NEGAT := (POS (NE, TOK_IN) > 0);
    IF NEGAT
      THEN TOK_OUT := COPY (TOK_IN, 4, LENGTH (TOK_IN) - 3)
      ELSE TOK_OUT := TOK_IN;
    P := POS (BL, TOK_IN);
    IF P > 0
      THEN TOK_OUT := COPY (TOK_OUT, 1, P - 1);
    L := LENGTH (TOK_OUT);
    IF TOK_OUT [L] IN ['1'..'6']
      THEN TOK_OUT := COPY (TOK_OUT, 1, L - 1);
  END;


  PROCEDURE MAKE_PAIRS_V;
          (*============*)

    VAR
      I, J, K, P, PI, PJ, LI, LJ : INTEGER;
      PQ : INTEGER;
      FOUND, REVERSE : BOOLEAN;
      TMP_LIN : STR115;
      TMP_TKN : STR115;
      TMPV, TMPV2 : STR115;

  BEGIN
    FOR I := 1 TO V_AMT DO
      WITH VERBS [I] DO
        SPLIT_VERB (LIN, TKN);

  (*  *)
    FOR I := 1 TO V_AMT DO
      FOR J := I + 1 TO V_AMT DO
        IF VERBS [I].TKN > VERBS [J].TKN
          THEN
            BEGIN
              TMP_LIN := VERBS [I].LIN;
              TMP_TKN := VERBS [I].TKN;
              VERBS [I].LIN := VERBS [J].LIN;
              VERBS [I].TKN := VERBS [J].TKN;
              VERBS [J].LIN := TMP_LIN;
              VERBS [J].TKN := TMP_TKN;
            END;

    FOR I := 1 TO V_AMT DO
      FOR J := I + 1 TO V_AMT DO
        BEGIN
          FOUND := FALSE;
          LI := LENGTH (VERBS [I].TKN);
          LJ := LENGTH (VERBS [J].TKN);

 (*    '',      *)
          PI := POS ('', VERBS [I].TKN);
          PJ := POS ('', VERBS [J].TKN);
          IF (PI > 0) AND (PJ > 0) AND (LI - PI = LJ - PJ)
            THEN
              BEGIN
                K := 0;
                REPEAT
                  INC (K);
                  PQ := PI - LENGTH (ASPECT_PAIRS [K, 1]);
                  IF (COPY (VERBS [I].TKN, PQ,
                      LENGTH (ASPECT_PAIRS [K, 1])) = ASPECT_PAIRS [K, 1])
                    AND (LI - LJ = LENGTH (ASPECT_PAIRS [K, 1]) -
                      LENGTH (ASPECT_PAIRS [K, 2]))
                    THEN
                      BEGIN
                        TMPV := VERBS [I].TKN;
                        DELETE (TMPV, PQ, LENGTH (ASPECT_PAIRS [K, 1]));
                        INSERT (ASPECT_PAIRS [K, 2], TMPV, PQ);
                        FOUND := (TMPV = VERBS [J].TKN)

(*    *)
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '') 
                          AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') 
                          AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          AND (TMPV <> '') AND (TMPV <> '')
                          ;
                        REVERSE := (ASPECT_PAIRS [K, 3] = '0');
                      END
                UNTIL FOUND OR (K = MAXT6T6);
              END;

  (*    '',  -  ''  '' *)
          K := 0;
          IF NOT FOUND
            THEN
              REPEAT
                INC (K);
                PQ := POS (ASPECT_PAIRS2 [K, 1], VERBS [I].TKN);
                IF (PQ > 0) AND (LI - LJ = LENGTH (ASPECT_PAIRS2 [K, 1]) -
                  LENGTH (ASPECT_PAIRS2 [K, 2]))
                  THEN
                    BEGIN
                      TMPV := VERBS [I].TKN;
                      DELETE (TMPV, PQ, LENGTH (ASPECT_PAIRS2 [K, 1]));
                      INSERT (ASPECT_PAIRS2 [K, 2], TMPV, PQ);
                      FOUND := (TMPV = VERBS [J].TKN)
                        AND (TMPV <> '') AND (TMPV <> '')
                        AND (TMPV <> '');
                      REVERSE := (ASPECT_PAIRS2 [K, 3] = '0');
                    END;
              UNTIL FOUND OR (K = MAXT6TI);

(*      *)
          IF NOT FOUND AND (LI <> LJ)
            THEN
              BEGIN
                IF LI < LJ
                  THEN
                    BEGIN
                      TMPV := VERBS [I].TKN;
                      TMPV2 := VERBS [J].TKN;
                      REVERSE := FALSE;
                    END
                  ELSE
                    BEGIN
                      TMPV := VERBS [J].TKN;
                      TMPV2 := VERBS [I].TKN;
                      REVERSE := TRUE;
                    END;
                K := 0;
                REPEAT
                  INC (K);
                  FOUND := (AS_PRS[K] + TMPV = TMPV2)
(*  .       *)
                    AND (TMPV <> '')AND (TMPV <> '') 
                    AND (TMPV <> '')  AND (TMPV <> '') 
                    AND (TMPV <> '')  AND (TMPV <> '') 
                    AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '')  
                    AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '') AND (TMPV <> '') 
                    AND (TMPV <> '')
                    AND (TMPV <> '') AND (TMPV <> '') 

(*  -       *)
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                   { AND ((TMPV <> '') OR (AS_PRS[K] = '')) }
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    AND ((TMPV <> '') OR (AS_PRS[K] = ''))
                    ;
                UNTIL FOUND OR (K = MAXPREF);
              END;

  (*        *)
          IF NOT FOUND
            THEN
              BEGIN
          IF (VERBS [I].TKN = '') AND (VERBS [J].TKN = '')
            THEN
              BEGIN
                FOUND := TRUE;
                REVERSE := TRUE;
              END
            ELSE IF (VERBS [I].TKN = VERBS [J].TKN)
              AND (POS ('', VERBS [I].TKN) > 0)
              THEN
                BEGIN
                  FOUND := TRUE;
                  REVERSE := (VERBS [I].LIN [LENGTH (VERBS [I].TKN) + 1] = '1');
                END;
              END;

  (*    '. - .'    *)
          IF FOUND
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = '')) 
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = '')) 
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = '')) 
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = ' ') AND (VERBS[J].TKN = ' '))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[J].TKN = '') AND (VERBS[I].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            AND NOT((VERBS[I].TKN = '') AND (VERBS[J].TKN = ''))
            THEN
              BEGIN
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '5' + BL2 + '5', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '5' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '6' + BL2 + '6', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '3' + BL2 + '3', ROOT);
                ALLOC_IN_TREE ('2 '+ '4' + BL2 + '4', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '' + BL2 + '', ROOT);
                ALLOC_IN_TREE ('2 '+ '1' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '2', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '1', ROOT);
                ALLOC_IN_TREE ('2 '+ '2' + BL2 + '', ROOT);


                IF REVERSE
                  THEN ALLOC_IN_TREE ('2 '+ VERBS[J].LIN + BL2 + VERBS[I].LIN,
                    ROOT)
                  ELSE ALLOC_IN_TREE ('2 '+ VERBS[I].LIN + BL2 + VERBS[J].LIN,
                    ROOT);
                INC (PAIRAMT_V);
              END;
        END;

    V_AMT := 0;
    INIT_VERBS;
  END;


BEGIN      (* MAIN *)

  PAIRAMT_N := 0;
  PAIRAMT_V := 0;
  COUNT := 0;
  N_AMT := 0;
  V_AMT := 0;
  INIT_NOUNS;
  INIT_VERBS;
  ROOT := NIL;

  ASSIGN (INP, 'DERIVAT.TXT');
  RESET (INP);
  CURSTAT := ZERO;

  ASSIGN (OUT, 'PAIRS.DAT');
  REWRITE (OUT);


  REPEAT
    READLN (INP, LINE);
    INIT := COPY (LINE, 1, 2);

    IF (INIT = 'ye') OR (INIT = 'no')
       THEN CURSTAT := ZERO
    ELSE IF (CURSTAT = ZERO) AND (INIT = 'Su')
      THEN CURSTAT := SUB
    ELSE IF (CURSTAT = SUB) AND (INIT = 'Ve')
      THEN
        BEGIN
          MAKE_PAIRS_N;
          CURSTAT := VERB;
        END
    ELSE IF (CURSTAT = SUB) AND (INIT = 'Aj')
      THEN           
        BEGIN
          MAKE_PAIRS_N;
          CURSTAT := ADJ;
        END
    ELSE IF (CURSTAT = VERB) AND (INIT = 'Aj')
      THEN
        BEGIN
          MAKE_PAIRS_V;
          CURSTAT := ADJ;
        END
    ELSE IF (CURSTAT = ADJ) AND (INIT = 'Av')
      THEN CURSTAT := ADV
   { ELSE IF (CURSTAT = ADV) AND 
      ((INIT = 'ye') OR (INIT = 'no'))
      THEN CURSTAT := ZERO };

    TAIL := COPY (LINE, 4, LENGTH (LINE) - 3);

    CASE CURSTAT OF
      SUB :
        BEGIN
          INC (N_AMT);
          NOUNS [N_AMT].LIN := TAIL;
        END;
      VERB :
        BEGIN
          INC (V_AMT);
          VERBS [V_AMT].LIN := TAIL;
        END;
      ELSE ;
    END;
  UNTIL EOF (INP);
  CLOSE (INP);

  BORDER := FALSE;
  PRINT_TREE (ROOT);
  FLUSH (OUT);
  CLOSE (OUT);

 (* Dividing pairs to nouns and verbs *)
 
  ASSIGN (INP, 'PAIRS.DAT');
  RESET (INP);

  ASSIGN (OUTN, 'PAIRS1.DAT');
  REWRITE (OUTN);

  ASSIGN (OUTV, 'PAIRV.DAT');
  REWRITE (OUTV);

  READLN (INP, LINE);
  WHILE (COPY(LINE, 1, 2) = '1 ') DO
    BEGIN
      WRITELN (OUTN, LINE);
      READLN (INP, LINE);
    END;
  FLUSH (OUTN);
  CLOSE (OUTN);

  WHILE {(COPY(LINE, 1, 2) = '2 ') AND} NOT EOF(INP) DO
    BEGIN
      WRITELN (OUTV, LINE);
      READLN (INP, LINE);
    END;
  WRITELN (OUTV, LINE);
  
  FLUSH (OUTV); 
  CLOSE (OUTV);

  WRITELN ('Files PAIRS1.DAT and PAIRV.DAT output');
  WRITELN (NCNT : 6 , ' noun pairs in PAIRS1.DAT');
  WRITELN ((COUNT - NCNT) : 6 , ' verb pairs in PAIRV.DAT');
END.
