PROGRAM SINGMUL3;

  TYPE
    STR3 = STRING [3];
    STR5 = STRING [5];
    STR6 = STRING [6];
    STR15 = STRING [15];
    STR45 = STRING [55];
    STR115 = STRING [115];
  CONST
    BL = ' ';
    HY = '-';
    DUMMY = '';
    MAX = 52;
    MAXBSN = 42000; { Increased !!! }
    
{ List of SINGL-PLUR or PLUR-SINGL endings of the same length }
 
    MAX0 = 28;
    NUMB_PAIRS0 : ARRAY [1..MAX0, 1..2] OF STR3 =
(*01*)(('Ä',     'à'),     (* ëíêéäÄ *)
(*02*) ('Ä',     'Ö'),     (* ìóàãàôÄ *)
(*03*) ('Ä',     'é'),     (* éÅãÄäÄ *)
(*04*) ('Ä',     'õ'),     (* ëíÖçÄ *)
(*05*) ('Äü',    'õÖ'),    (* ÇÄççÄü *)
(*06*) ('Åõ',    'éÅ'),    (* ãÅõ *)
(*07*) ('Çõ',    'éÇ'),    (* êÇõ *)
(*08*) ('Ö',     'ü'),     (* áÑÄçàÖ *)
(*09*) ('Ö',     'â'),     (* êÄÅéóàÖ *)
(*10*) ('Öä',    'äà'),    (* äÄåÖòÖä *)
(*11*) ('Öã',    'ãõ'),    (* éëÖã *)
(*12*) ('Öê',    'êõ'),    (* ÇÖíÖê *)
(*13*) ('Öë',    'ëõ'),    (* èÖë *)
(*14*) ('Öñ',    'ñõ'),    (* çÖåÖñ *)
(*15*) ('à',     'â'),     (* Åéà *)
(*16*) ('à',     'é'),     (* èãÖóà *)
(*17*) ('à',     'ú'),     (* ëíÖèà *)
(*18*) ('à',     'ü'),     (* áÖåãà *)
(*19*) ('Öëü',   'âëü'),   (* íêìÑüôàÖëü *)
(*20*) ('äà',    'éä'),    (* åÖòäà *)
(*21*) ('ãõ',    'éã'),    (* èéëãõ *)
(*22*) ('çõ',    'éç'),    (* ëçõ *)
(*23*) ('éÖ',    'àÖ'),    (* åÄíÖåÄíàóÖëäéÖ *)
(*24*) ('éÖ',    'õÖ'),    (* ÇíéêéÖ *)
(*25*) ('éâ',    'õÖ'),    (* ÇõïéÑçéâ *)
(*26*) ('éê',    'êõ'),    (* Çàïéê *)
(*27*) ('éí',    'íõ'),    (* êéí *)
(*28*) ('ú',     'ü'));    (* ìóàíÖãú *)

{ List of SINGL-PLUR or PLUR-SINGL endings of different lengths }
  MAX1 = 27;
  NUMB_PAIRS1 : ARRAY [1..MAX1, 1..2] OF STRING [4] =
(*01*)(('',      'Ä'),     (* Ñéäíéê *)
(*02*) ('',      'à'),     (* ÑìêÄä *)
(*03*) ('',      'éÇúü'),  (* ëõç *)
(*04*) ('',      'õ'),     (* ëíÄäÄç *)
(*05*) ('',      'úü'),    (* ëíìã *)
(*06*) ('Ä',     'àç'),    (* ÉéëèéÑÄ *)
(*07*) ('Ä',     'çé'),    (* ëìÑÄ *)
(*08*) ('ÄíÄ',   'éçéä'),  (* åõòÄíÄ *)
(*09*) ('É',     'áúü'),   (* ÑêìÉ *)
(*10*) ('Ö',     'àç'),    (* ÄêåüçÖ *)
(*11*) ('ÖÇ',    'úÇõ'),   (* ãÖÇ *)
(*12*) ('ÖÇÄ',   'àç'),    (* ïéáüÖÇÄ *)
(*13*) ('ÖÑ',    'úÑõ'),   (* ãÖÑ *)
(*14*) ('Öä',    'âäà'),   (* ÅéÖä *)
(*15*) ('Öä',    'úäà'),   (* äéòÖãÖä *)
(*16*) ('Öå',    'âåõ'),   (* áÄÖå *)
(*17*) ('ÖçÄ',   'ü'),     (* áçÄåÖçÄ *)
(*18*) ('Öçéä',  'üíÄ'),   (* üÉçÖçéä *)
(*19*) ('Öçú',   'çà'),    (* èÄêÖçú *)
(*20*) ('Öêà',   'ú'),     (* Ñéóú *)
(*21*) ('Öñ',    'âñõ'),   (* ÅéÖñ *)
(*22*) ('Öñ',    'úñõ'),   (* ìåÖãÖñ *)
(*23*) ('àç',    'õ'),     (* ÅéãÉÄêàç *)
(*24*) ('âñõ',   'üñ'),    (* áÄâñõ *)
(*25*) ('çà',    'éçú'),   (* éÉçà *)
(*26*) ('é',     'úü'),    (* ÑÖêÖÇé *)
(*27*) ('éíú',   'íà'));   (* ãéäéíú *)


{ List of indeclinable SINGL=PLUR nouns }
  MAX_NOINCL = 18;
  NOINCL : ARRAY [1..MAX_NOINCL] OF STR45 =
('ÄÇÖçû','ÄíÖãúÖ','Åûêé','àçíÖêÇúû',
'äÄáàçé','äÄîÖ','äãàòÖ','åÖçû','èÄãúíé','èÄççé',
'íÄÅì','íÄäëà','íÖãÖÄíÖãúÖ',
'îéíé','îéíéÄíÖãúÖ','ñìçÄåà','òéëëÖ','òéì');

{ List of letter-distant SINGL-PLUR pairs }
  ADD_MAX = 42;
  ADD_PAIRS : ARRAY [1..ADD_MAX, 1..2] OF STR15 =
(('Äë','Äëõ'),
 ('ÅÖë','ÅÖëõ'),
 ('ÅÄòäÄ','Åéòäà'),
 ('Çéá','Çéáõ'),
 ('Çéòú','Çòà'),
 ('Ééã','Ééãõ'),
 ('ÉéêÄ','Ééêõ'),
 ('ÉéêÖñ','Ééêñõ'),
 ('ÑÖçú','Ñçà'),
 ('Ñçé','Ñéçúü'),
 ('ÑêìÜàôÖ','ÑêìÜàôà'),
 ('áÄå','áÄåõ'),
 ('áÄêü','áéêà'),
 ('áÄüñ','áÄâñõ'),
 ('áìÅ','áìÅõ'),
 ('äÄêÄ','äÄêõ'),
 ('äéã','äéãúü'),
 ('äéå','äéåúü'),
 ('äéç','äéçõ'),
 ('ãÖÑ','ãúÑõ'),
 ('ãéÅ','ãÅõ'),
 ('éäé','éóà'),
 ('éëÄ','éëõ'),
 ('éëú','éëà'),
 ('éíÖñ','éíñõ'),
 ('èÖçú','èçà'),
 ('èÖêÖñ','èÖêñõ'),
 ('èÖë','èëõ'),
 ('êÄëÄ','êÄëõ'),
 ('êéÇ','êÇõ'),
 ('ëÄåÖñ','ëÄåñõ'),
 ('ëÇÖêïóÖãéÇÖä','ëÇÖêïãûÑà'),
 ('ëÖãé','ëÖãÄ'),
 ('ëíÄü','ëíÄà'),
 ('íìü','íìà'),
 ('ìãÖâ','ìãúà'),
 ('ìïé','ìòà'),
 ('óÖãéÇÖä','ãûÑà'),
 ('óàêÖâ','óàêúà'),
 ('òÖü','òÖà'),
 ('òàãé','òàãúü'),
 ('òéÇ','òÇõ'));

{ List of numbered SINGL-PLUR pairs }
  NUMERD_MAX = 375;
  NUM_PAIRS : ARRAY [1..NUMERD_MAX, 0..2] OF STR15 =
(*  1*)(('2','ÄÇíéåÄí'     ,'ÄÇíéåÄíõ'    ), 
(*  2*) ('3','ÄÉÖçí'       ,'ÄÉÖçíõ'      ), 
(*  4*) ('2','Ääí'         ,'Ääíõ'        ), 
(*  5*) ('2','Ääñàü'       ,'Ääñàà'       ),
(*  6*) ('2','ÄêÉìåÖçí'    ,'ÄêÉìåÖçíõ'   ), 
(*  7*) ('2','ÄêíÖêàü'     ,'ÄêíÖêàà'     ),
(*  8*) ('2','ÄëëéñàÄñàü'  ,'ÄëëéñàÄñàà'  ),
(*  9*) ('2','ÄìÑàíéêàü'   ,'ÄìÑàíéêàà'   ),
(* 10*) ('2','ÄîÉÄçÖñ'     ,'ÄîÉÄçñõ'     ),
(* 11*) ('1','ÅÄä'         ,'ÅÄäà'        ),
(* 12*) ('2','ÅÄãäÄ'       ,'ÅÄãäà'       ),
(* 13*) ('2','ÅÄããéç'      ,'ÅÄããéçõ'     ),
(* 14*) ('1','ÅÄçä'        ,'ÅÄçäà'       ), 
(* 15*) ('2','ÅÄíÄêÖü'     ,'ÅÄíÄêÖà'     ),
(* 16*) ('2','ÅÄòåÄä'      ,'ÅÄòåÄäà'     ),
(* 18*) ('3','ÅÖãéä'       ,'ÅÖãäà'       ), 
(* 17*) ('3','ÅàãÖí'       ,'ÅàãÖíõ'      ), 
(* 18*) ('3','Åãéä'        ,'Åãéäà'       ), 
(* 19*) ('2','ÅãûÑé'       ,'ÅãûÑÄ'       ),
(* 20*) ('2','ÅéÖÇàä'      ,'ÅéÖÇàäà'     ), 
(* 21*) ('2','ÅéäëÖê'      ,'ÅéäëÖêõ'     ), 
(* 22*) ('4','Åéêí'        ,'ÅéêíÄ'       ), 
(* 23*) ('2','ÅéóäÄ'       ,'Åéóäà'       ),
(* 24*) ('2','ÅêàÉÄÑÄ'     ,'ÅêàÉÄÑõ'     ),
(* 25*) ('2','Åìçí'        ,'Åìçíõ'       ), 
(* 26*) ('2','Åõä'         ,'Åõäà'        ), 
(* 27*) ('2','Åõóéä'       ,'Åõóäà'       ),
(* 28*) ('2','ÇÖáÑÖïéÑ'    ,'ÇÖáÑÖïéÑõ'   ), 
(* 29*) ('2','ÇÖíäÄ'       ,'ÇÖíäà'       ),
(* 30*) ('2','ÇÖóÖê'       ,'ÇÖóÖêÄ'      ), 
(* 31*) ('3','ÇÖôú'        ,'ÇÖôà'        ),
(* 32*) ('2','ÇáÉãüÑ'      ,'ÇáÉãüÑõ'     ),
(* 33*) ('2','ÇàãäÄ'       ,'Çàãäà'       ),
(* 34*) ('2','Çàêìë'       ,'Çàêìëõ'      ), 
(* 35*) ('2','ÇäãÄÑ'       ,'ÇäãÄÑõ'      ), 
(* 36*) ('2','ÇãéÜÖçàÖ'    ,'ÇãéÜÖçàü'    ),
(* 37*) ('2','Çéèêéë'      ,'Çéèêéëõ'     ), 
(* 38*) ('1','ÇõÇéÑ'       ,'ÇõÇéÑõ'      ), 
(* 39*) ('2','ÇõáéÇ'       ,'ÇõáéÇõ'      ), 
(* 40*) ('2','ÇõêÄÜÖçàÖ'   ,'ÇõêÄÜÖçàü'   ),
(* 41*) ('2','ÇõëíêÖã'     ,'ÇõëíêÖãõ'    ), 
(* 42*) ('2','ÇõëíìèãÖçàÖ' ,'ÇõëíìèãÖçàü' ),
(* 43*) ('2','ÇõóÖí'       ,'ÇõóÖíõ'      ), 
(* 43*) ('2','ÇúÖíçÄåäÄ'   ,'ÇúÖíçÄåäà'   ), 
(* 44*) ('2','ÉÄêåéçàäÄ'   ,'ÉÄêåéçàäà'   ),
(* 45*) ('1','ÉÄêçàíìêÄ'   ,'ÉÄêçàíìêõ'   ),
(* 46*) ('1','ÉÇéáÑàäÄ'    ,'ÉÇéáÑàäà'    ),
(* 47*) ('2','ÉÖêéâ'       ,'ÉÖêéà'       ),
(* 48*) ('2','ÉàÅêàÑ'      ,'ÉàÅêàÑõ'     ),
(* 49*) ('2','ÉãÄÇÄ'       ,'ÉãÄÇõ'       ),
(* 50*) ('2','Ééãéë'       ,'ÉéãéëÄ'      ),
(* 51*) ('2','ÉéêéÑéä'     ,'ÉéêéÑäà'     ),
(* 52*) ('2','ÉêÄî'        ,'ÉêÄîõ'       ), 
(* 53*) ('3','ÉêÄîàä'      ,'ÉêÄîàäà'     ),
(* 54*) ('2','ÉêìáéÇàä'    ,'ÉêìáéÇàäà'   ), 
(* 55*) ('2','ÉìëÖçàñÄ'    ,'ÉìëÖçàñõ'    ),
(* 56*) ('3','ÑÄåÄ'        ,'ÑÄåõ'        ),
(* 57*) ('2','ÑÇàÜÖçàÖ'    ,'ÑÇàÜÖçàü'    ),
(* 58*) ('2','ÑÇéâçàä'     ,'ÑÇéâçàäà'    ),
(* 59*) ('2','ÑÇéêçàä'     ,'ÑÇéêçàäà'    ), 
(* 60*) ('3','ÑÖâëíÇàÖ'    ,'ÑÖâëíÇàü'    ), 
(* 61*) ('2','ÑÖãé'        ,'ÑÖãÄ'        ),
(* 62*) ('2','ÑÖåéçëíêÄñàü','ÑÖåéçëíêÄñàà'),
(* 63*) ('2','ÑÖêÖÇé'      ,'ÑÖêÖÇúü'     ), 
(* 64*) ('2','ÑÖíÄãú'      ,'ÑÖíÄãà'      ),
(* 65*) ('2','ÑÖíÖäíàÇ'    ,'ÑÖíÖäíàÇõ'   ),
(* 66*) ('2','Ñàèãéå'      ,'Ñàèãéåõ'     ), 
(* 67*) ('2','ÑàèãéåÄí'    ,'ÑàèãéåÄíõ'   ), 
(* 68*) ('5','Ñàëä'        ,'Ñàëäà'       ),
(* 69*) ('3','Ñéå'         ,'ÑéåÄ'        ), 
(* 70*) ('3','ÑéêéÜäÄ'     ,'ÑéêéÜäà'     ),
(* 71*) ('2','ÑéëäÄ'       ,'Ñéëäà'       ),
(* 72*) ('4','ÖÑàçàñÄ'     ,'ÖÑàçàñõ'     ),
(* 73*) ('2','ÜìêçÄã'      ,'ÜìêçÄãõ'     ), 
(* 74*) ('4','Üìóéä'       ,'Üìóäà'       ),
(* 75*) ('2','áÄÉéíéÇäÄ'   ,'áÄÉéíéÇäà'   ),
(* 76*) ('2','áÄâóàä'      ,'áÄâóàäà'     ),
(* 77*) ('2','áÄäéç'       ,'áÄäéçõ'      ), 
(* 78*) ('2','áÄåÖíäÄ'     ,'áÄåÖíäà'     ),
(* 79*) ('2','áÄåéä'       ,'áÄåäà'       ),
(* 80*) ('2','áÄèéê'       ,'áÄèéêõ'      ),
(* 81*) ('3','áÄíüÜäÄ'     ,'áÄíüÜäà'     ),
(* 82*) ('2','áÄôàíçàä'    ,'áÄôàíçàäà'   ), 
(* 83*) ('4','áÇÖáÑÄ'      ,'áÇÖáÑõ'      ),
(* 84*) ('2','áÇÖçé'       ,'áÇÖçúü'      ), 
(* 85*) ('3','áÇéçéä'      ,'áÇéçäà'      ),
(* 86*) ('2','áÇìä'        ,'áÇìäà'       ), 
(* 87*) ('2','àáåÖêÖçàÖ'   ,'àáåÖêÖçàü'   ),
(* 88*) ('2','àáéãüíéê'    ,'àáéãüíéêõ'   ), 
(* 89*) ('2','àçÑàäÄíéê'   ,'àçÑàäÄíéêõ'  ), 
(* 90*) ('2','àçîéêåÄíéê'  ,'àçîéêåÄíéêõ' ), 
(* 91*) ('2','àëäãûóÖçàÖ'  ,'àëäãûóÖçàü'  ),
(* 92*) ('2','àëèõíÄçàÖ'   ,'àëèõíÄçàü'   ),
(* 93*) ('4','àëíéóçàä'    ,'àëíéóçàäà'   ), 
(* 94*) ('2','äÄÅÄóéä'     ,'äÄÅÄóäà'     ),
(* 95*) ('2','äÄÅàçÖí'     ,'äÄÅàçÖíõ'    ), 
(* 96*) ('2','äÄáÄä'       ,'äÄáÄäà'      ), 
(* 97*) ('2','äÄåÖêÄ'      ,'äÄåÖêõ'      ),
(* 98*) ('2','äÄçÄã'       ,'äÄçÄãõ'      ), 
(* 99*) ('2','äÄçÑàÑÄí'    ,'äÄçÑàÑÄíõ'   ), 
(*100*) ('3','äÄêíÄ'       ,'äÄêíõ'       ),
(*101*) ('5','äÄêíéóäÄ'    ,'äÄêíéóäà'    ),
(*102*) ('1','äÄêúÖê'      ,'äÄêúÖêõ'     ), 
(*102*) ('2','äÇÄêíÄã'     ,'äÇÄêíÄãõ'    ), 
(*103*) ('3','äàëíú'       ,'äàëíà'       ),
(*104*) ('4','äãÄëë'       ,'äãÄëëõ'      ),
(*105*) ('4','äãÖíäÄ'      ,'äãÖíäà'      ),
(*106*) ('2','äãàä'        ,'äãàäà'       ),
(*107*) ('2','äãìÅ'        ,'äãìÅõ'       ),
(*108*) ('4','äãûó'        ,'äãûóà'       ),
(*108*) ('2','äçàÉÄ'       ,'äçàÉà'       ),
(*109*) ('2','äéÑ'         ,'äéÑõ'        ),
(*110*) ('1','äéáÖã'       ,'äéáãõ'       ),
(*111*) ('3','äéãéçàü'     ,'äéãéçàà'     ),
(*112*) ('4','äéãéçäÄ'     ,'äéãéçäà'     ),
(*113*) ('2','äéãéççÄ'     ,'äéãéççõ'     ),
(*114*) ('2','äéåÄçÑÄ'     ,'äéåÄçÑõ'     ),
(*115*) ('2','äéåèÄçàü'    ,'äéåèÄçàà'    ),
(*116*) ('2','äéåèãÖäë'    ,'äéåèãÖäëõ'   ),
(*116*) ('2','äéçíÄäí'     ,'äéçíÄäíõ'    ),
(*117*) ('3','äéçëíêìäñàü','äéçëíêìäñàà'  ),
(*118*) ('2','äéêÄÅãú'     ,'äéêÄÅãà'     ),
(*119*) ('4','äéêÖçú'      ,'äéêçà'       ),
(*120*) ('3','äéêàÑéê'     ,'äéêàÑéêõ'    ),
(*121*) ('2','äéêéÅéóäÄ'   ,'äéêéÅéóäà'   ),
(*122*) ('4','äéêéãú'      ,'äéêéãà'      ),
(*123*) ('6','äéêèìë'      ,'äéêèìëÄ'     ),
(*124*) ('2','äêÄâ'        ,'äêÄü'        ),
(*125*) ('2','äêÄç'        ,'äêÄçõ'       ),
(*126*) ('2','äêéòäÄ'      ,'äêéòäà'      ),
(*127*) ('3','äêìÉ'        ,'äêìÉà'       ),
(*128*) ('1','äêìÜéä'      ,'äêìÜäà'      ),
(*129*) ('3','äêûóéä'      ,'äêûóäà'      ),
(*130*) ('3','äìãÄä'       ,'äìãÄäà'      ),
(*131*) ('2','äìãúíìêÄ'    ,'äìãúíìêõ'    ),
(*132*) ('2','äìèûêÄ'      ,'äìèûêõ'      ),
(*133*) ('2','äìèûêÄ'      ,'äìèûêÄ'      ),
(*134*) ('5','äìêë'        ,'äìêëõ'       ),
(*135*) ('2','ãÄÇäÄ'       ,'ãÄÇäà'       ),
(*136*) ('2','ãÄÇéóäÄ'     ,'ãÄÇéóäà'     ),
(*137*) ('1','ãÄâäÄ'       ,'ãÄâäà'       ),
(*138*) ('2','ãÄâçÖê'      ,'ãÄâçÖêõ'     ),
(*139*) ('2','ãÄëäÄ'       ,'ãÄëäà'       ),
(*140*) ('2','ãÖÇÄä'       ,'ãÖÇÄäà'      ),
(*141*) ('4','ãÖçíÄ'       ,'ãÖçíõ'       ),
(*142*) ('2','ãÖë'         ,'ãÖëÄ'        ),
(*143*) ('2','ãàÉÄíìêÄ'    ,'ãàÉÄíìêõ'    ),
(*144*) ('2','ãàçÖâäÄ'     ,'ãàçÖâäà'     ),
(*145*) ('4','ãàçàü'       ,'ãàçàà'       ),
(*145*) ('2','ãàêÄ'        ,'ãàêõ'       ),
(*146*) ('1','ãàñé'        ,'ãàñÄ'        ),
(*147*) ('2','ãàóàçäÄ'     ,'ãàóàçäà'     ),
(*148*) ('2','ãéèÄíäÄ'     ,'ãéèÄíäà'     ),
(*149*) ('2','åÄÉàëíêÄãú'  ,'åÄÉàëíêÄãà'  ),
(*150*) ('2','åÄçàèìãüíéê' ,'åÄçàèìãüíéêõ'),
(*151*) ('4','åÄêäÄ'       ,'åÄêäà'       ),
(*152*) ('3','åÄêò'        ,'åÄêòà'       ),
(*153*) ('3','åÄëíÖê'      ,'åÄëíÖêÄ'     ),
(*154*) ('2','åÄíÖêàÄã'    ,'åÄíÖêàÄãõ'   ),
(*155*) ('3','åÄòàçÄ'      ,'åÄòàçõ'      ),
(*156*) ('2','åÖêÄ'        ,'åÖêõ'        ),
(*157*) ('57','åÖëíé'       ,'åÖëíÄ'       ),
(*158*) ('2','åÖïÄçàáå'    ,'åÖïÄçàáåõ'   ),
(*159*) ('2','åàçÄ'        ,'åàçõ'        ),
(*160*) ('2','åéÑÖãú'      ,'åéÑÖãà'      ),
(*161*) ('3','åéåÖçí'      ,'åéåÖçíõ'     ),
(*162*) ('2','åéíàÇ'       ,'åéíàÇõ'      ),
(*163*) ('3','çÄêüÑ'       ,'çÄêüÑõ'      ),
(*164*) ('2','çéÜäÄ'       ,'çéÜäÄ'       ),
(*165*) ('4','çéåÖê'       ,'çéåÖêÄ'      ),
(*166*) ('2','çéêäÄ'       ,'çéêäà'       ),
(*167*) ('2','çõêéä'       ,'çõêäà'       ),
(*168*) ('3','éÅãÄëíú'     ,'éÅãÄëíà'     ),
(*169*) ('1','éÅêÄôÖçàÖ'   ,'éÅêÄôÖçàü'   ),
(*170*) ('2','éÅêõÇ'       ,'éÅêõÇõ'      ), 
(*171*) ('2','éÅëíéüíÖãúëíÇé','éÅëíéüíÖãúëíÇÄ'),
(*172*) ('2','éäãÄÑ'       ,'éäãÄÑõ'      ),
(*173*) ('3','éèÖêÄíéê'    ,'éèÖêÄíéêõ'   ),
(*174*) ('2','éêÉÄç'       ,'éêÉÄçõ'      ),
(*175*) ('2','éêìÑàÖ'      ,'éêìÑàü'      ),
(*176*) ('2','éëçéÇÄçàÖ'   ,'éëçéÇÄçàü'   ),
(*177*) ('2','éíÇÖíóàä'    ,'éíÇÖíóàäà'   ),
(*178*) ('2','éíáõÇ'       ,'éíáõÇõ'      ),
(*179*) ('2','éíäÄá'       ,'éíäÄáõ'      ),
(*180*) ('2','éíäÄí'       ,'éíäÄíõ'      ),
(*181*) ('2','éíäãéçÖçàÖ'  ,'éíäãéçÖçàü'  ),
(*182*) ('2','éíåÖíäÄ'     ,'éíåÖíäà'     ),
(*183*) ('1','éíçéòÖçàÖ'   ,'éíçéòÖçàü'   ),
(*184*) ('2','éíèêÄÇãÖçàÖ' ,'éíèêÄÇãÖçàü' ),
(*185*) ('2','éíóàëãÖçàÖ'  ,'éíóàëãÖçàü'  ),
(*186*) ('2','éñÖçäÄ'      ,'éñÖçäà'      ),
(*187*) ('2','éóÄÉ'        ,'éóÄÉà'       ),
(*188*) ('2','éóÖêÖÑú'     ,'éóÖêÖÑà'     ),
(*189*) ('2','èÄäÖí'       ,'èÄäÖíõ'      ),
(*190*) ('2','èÄãÄíÄ'      ,'èÄãÄíõ'      ),
(*191*) ('2','èÄãÄíäÄ'     ,'èÄãÄíäà'     ),
(*192*) ('2','èÄãÖñ'       ,'èÄãúñõ'      ),
(*193*) ('3','èÄãéóäà'     ,'èÄãéóäà'     ),
(*194*) ('2','èÄçÖãú'      ,'èÄçÖãà'      ),
(*195*) ('3','èÄêÄ'        ,'èÄêõ'        ),
(*196*) ('2','èÄêä'        ,'èÄêäà'       ), 
(*197*) ('2','èÄêíàü'      ,'èÄêíàà'      ),
(*198*) ('3','èÄíêéç'      ,'èÄíêéçõ'     ), 
(*199*) ('2','èÄóäÄ'       ,'èÄóäà'       ),
(*200*) ('2','èÖòäÄ'       ,'èÖòäà'       ), 
(*201*) ('2','èàéç'        ,'èàéçõ'       ), 
(*202*) ('2','èàêÄåàÑÄ'    ,'èàêÄåàÑõ'    ),
(*203*) ('2','èãÄëíàçäÄ'   ,'èãÄëíàçäà'   ),
(*204*) ('2','èãÄíîéêåÄ'   ,'èãÄíîéêåõ'   ),
(*205*) ('2','èãàíÄ'       ,'èãàíõ'       ),
(*206*) ('2','èãàíäÄ'      ,'èãàíäà'      ),
(*207*) ('1','èãéôÄÑú'     ,'èãéôÄÑà'     ),
(*208*) ('2','èéÅÖÉ'       ,'èéÅÖÉà'      ),
(* 43*) ('2','èéÉÄçäÄ'     ,'èéÉÄçäà'     ), 
(*209*) ('2','èéÑïéÑ'      ,'èéÑïéÑõ'     ), 
(*210*) ('2','èéÑöÖáÑ'     ,'èéÑöÖáÑõ'    ), 
(*211*) ('3','èéáàñàü'     ,'èéáàñàà'     ),
(*212*) ('2','èéäÄáÄçàÖ'   ,'èéäÄáÄçàü'   ),
(*213*) ('2','èéã'         ,'èéãõ'        ), 
(*214*) ('1','èéãÖ'        ,'èéãü'        ),
(*215*) ('1','èéãäÄ'       ,'èéãäà'       ),
(*216*) ('2','èéêí'        ,'èéêíõ'       ), 
(*217*) ('2','èéêíüçäÄ'    ,'èéêíüçäà'    ),
(*218*) ('2','èéëéÅàÖ'     ,'èéëéÅàü'     ),
(*219*) ('4','èéëí'        ,'èéëíõ'       ), 
(*220*) ('2','èéëíìèãÖçàÖ' ,'èéëíìèãÖçàü' ),
(*221*) ('3','èéëõãäÄ'     ,'èéëõãäà'     ),
(*222*) ('2','èéóäÄ'       ,'èéóäà'       ),
(*223*) ('2','èéüë'        ,'èéüëÄ'       ), 
(*224*) ('1','èêÄÇé'       ,'èêÄÇÄ'       ),
(*225*) ('2','èêÖÑãéÉ'     ,'èêÖÑãéÉà'    ), 
(*226*) ('2','èêÖÑãéÜÖçàÖ' ,'èêÖÑãéÜÖçàü' ),
(*227*) ('2','èêÖéÅêÄáéÇÄíÖãú','èêÖéÅêÄáéÇÄíÖãà'),
(*228*) ('2','èêàÖå'       ,'èêàÖåõ'      ), 
(*229*) ('2','èêàãéÜÖçàÖ'  ,'èêàãéÜÖçàü'  ),
(*230*) ('3','èêéÅäÄ'      ,'èêéÅäà'      ),
(*231*) ('2','èêéÇÄã'      ,'èêéÇÄãõ'     ), 
(*232*) ('2','èêéÇéãéóäÄ'  ,'èêéÇéãéóäà'  ),
(*233*) ('5','èêéÉêÄååÄ'   ,'èêéÉêÄååõ'   ),
(*234*) ('1','èêéÑìäí'     ,'èêéÑìäíõ'    ),
(*235*) ('3','èêéîàãú'     ,'èêéîàãà'     ),
(*236*) ('3','èêéñÖëë'     ,'èêéñÖëëõ'    ),
(*237*) ('2','èíàóäÄ'      ,'èíàóäà'      ),
(*238*) ('2','èìáõêÖä'     ,'èìáõêúäà'    ), 
(*239*) ('2','èìçäí'       ,'èìçäíõ'      ), 
(*240*) ('2','èõòäÄ'       ,'èõòäà'       ),
(*241*) ('2','êÄÅéíÄ'      ,'êÄÅéíõ'      ),
(*242*) ('2','êÄÑàäÄã'     ,'êÄÑàäÄãõ'    ), 
(*243*) ('2','êÄáÇÖÑóàä'   ,'êÄáÇÖÑóàäà'  ), 
(*244*) ('3','êÄáÇüáäÄ'    ,'êÄáÇüáäà'    ),
(*245*) ('2','êÄáêÄÅéíäÄ'  ,'êÄáêÄÅéíäà'  ),
(*246*) ('2','êÄáêÖá'      ,'êÄáêÖáõ'     ), 
(*247*) ('3','êÄáêüÑ'      ,'êÄáêüÑõ'     ), 
(*248*) ('3','êÄäéÇàçÄ'    ,'êÄäéÇàçõ'    ),
(*249*) ('2','êÄäìòäÄ'     ,'êÄäìòäà'     ),
(*250*) ('2','êÄëíüÜäÄ'    ,'êÄëíüÜäà'    ),
(*251*) ('1','êÖÄäñàü'     ,'êÖÄäñàà'     ),
(*252*) ('2','êÖáàÑÖçí'    ,'êÖáàÑÖçíõ'   ), 
(*252*) ('2','êÖèãàäÄ'     ,'êÖèãàäà'     ), 
(*253*) ('3','êÖòÖçàÖ'     ,'êÖòÖçàü'     ),
(*254*) ('1','êéÑ'         ,'êéÑõ'        ), 
(*255*) ('2','êéãàä'       ,'êéãàäà'      ), 
(*256*) ('2','êìäÄÇ'       ,'êìäÄÇÄ'      ), 
(*257*) ('3','êìóäÄ'       ,'êìóäà'       ),
(*258*) ('2','êõçéä'       ,'êõçäà'       ),
(*259*) ('2','êõóÄÉ'       ,'êõóÄÉà'      ), 
(*260*) ('2','êüÑ'         ,'êüÑõ'        ),
(*261*) ('2','ëÄÑ'         ,'ëÄÑõ'        ), 
(*262*) ('2','ëÄãéç'       ,'ëÄãéçõ'      ), 
(*263*) ('2','ëÄíÖããàí'    ,'ëÄíÖããàíõ'   ), 
(*264*) ('2','ëÄóéä'       ,'ëÄóäà'       ),
(*265*) ('2','ëÇÄãäÄ'      ,'ëÇÄãäÄ'      ), 
(*266*) ('2','ëÇÄãäà'      ,'ëÇÄãäà'      ), 
(*267*) ('2','ëÇéÑ'        ,'ëÇéÑõ'       ), 
(*268*) ('2','ëÇüáäÄ'      ,'ëÇüáäà'      ),
(*269*) ('1','ëÇüáú'       ,'ëÇüáà'       ),
(*270*) ('3','ëÖäíéê'      ,'ëÖäíéêÄ'     ), 
(*271*) ('2','ëÖëíêÄ'      ,'ëÖëíêõ'      ),
(*272*) ('2','ëÖíú'        ,'ëÖíà'        ),
(*273*) ('4','ëàëíÖåÄ'     ,'ëàëíÖåõ'     ),
(*274*) ('2','ëãàÇÄ'       ,'ëãàÇõ'       ),
(*275*) ('2','ëãéâ'        ,'ëãéà'        ),
(*276*) ('1','ëãìÜÅÄ'      ,'ëãìÜÅõ'      ),
(*277*) ('3','ëçÄêüÑ'      ,'ëçÄêüÑõ'     ), 
(*276*) ('2','ëéÅêÄçàÖ'    ,'ëéÅêÄçàü'    ),
(*277*) ('2','ëéÇÖí'       ,'ëéÇÖíõ'      ), 
(*278*) ('2','ëéÇéä'       ,'ëéÇäà'       ),
(*279*) ('3','ëéÖÑàçÖçàÖ'  ,'ëéÖÑàçÖçàü'  ),
(*280*) ('2','ëéäêÄôÖçàÖ'  ,'ëéäêÄôÖçàü'  ),
(*281*) ('3','ëéëíÄÇ'      ,'ëéëíÄÇõ'     ), 
(*282*) ('2','ëéëíéüçàÖ'   ,'ëéëíéüçàü'   ),
(*283*) ('2','ëéëìÑ'       ,'ëéëìÑõ'      ), 
(*284*) ('2','ëèÖäìãüñàü'  ,'ëèÖäìãüñàà'  ),
(*285*) ('2','ëèìíçàä'     ,'ëèìíçàä'     ),
(*286*) ('1','ëêÖÑëíÇé'    ,'ëêÖÑëíÇÄ'    ),
(*287*) ('2','ëíÄíúü'      ,'ëíÄíúà'      ),
(*288*) ('4','ëíÇéã'       ,'ëíÇéãõ'      ), 
(*289*) ('2','ëíÖçäÄ'      ,'ëíÖçäà'      ),
(*290*) ('3','ëíÖèÖçú'     ,'ëíÖèÖçà'     ),
(*291*) ('2','ëíéèäÄ'      ,'ëíéèäà'      ),
(*292*) ('2','ëíéêéçÄ'     ,'ëíéêéçõ'     ),
(*293*) ('3','ëíêÖãäÄ'     ,'ëíêÖãäà'     ),
(*294*) ('2','ëíêìäíìêÄ'   ,'ëíêìäíìêõ'   ),
(*295*) ('2','ëìÅöÖäí'     ,'ëìÅöÖäíõ'    ), 
(*296*) ('1','ëìÑçé'       ,'ëìÑÄ'        ),
(*296*) ('2','ëìÑúü'       ,'ëìÑúà'       ),
(*297*) ('2','ëìäÄ'        ,'ëìäà'        ),
(*298*) ('2','ëïÇÄíäÄ'     ,'ëïÇÄíäà'     ),
(*299*) ('2','ëïÖåÄ'       ,'ëïÖåõ'       ),
(*300*) ('2','ëïéÑ'        ,'ëïéÑõ'       ),
(*301*) ('2','ëóÖíóàä'     ,'ëóÖíóàäà'    ), 
(*302*) ('2','íÄãÄçí'      ,'íÄãÄçíõ'     ), 
(*303*) ('2','íÄçä'        ,'íÄçäà'       ), 
(*304*) ('2','íÄóäÄ'       ,'íÄóäà'       ),
(*305*) ('2','íÖÄíê'       ,'íÖÄíêõ'      ),
(*306*) ('3','íÖãé'        ,'íÖãÄ'        ),
(*307*) ('2','íÖãÖîéç'     ,'íÖãÖîéçõ'    ), 
(*308*) ('2','íàè'         ,'íàèõ'        ), 
(*309*) ('2','íäÄçú'       ,'íäÄçà'       ),
(*310*) ('2','íéç'         ,'íéçÄ'        ), 
(*311*) ('2','íéëí'        ,'íéëíõ'       ), 
(*312*) ('2','íéóäÄ'       ,'íéóäà'       ),
(*313*) ('2','íêÄëëÄ'      ,'íêÄëëõ'      ),
(*314*) ('2','íêìÅÄ'       ,'íêìÅõ'       ),
(*315*) ('3','íêìÅäÄ'      ,'íêìÅäà'      ),
(*316*) ('2','íìÄãÖí'      ,'íìÄãÖíõ'     ), 
(*317*) ('2','íìá'         ,'íìáõ'        ), 
(*318*) ('2','ìÉéãéä'      ,'ìÉéãäà'      ),
(*319*) ('4','ìÑÄê'        ,'ìÑÄêõ'       ), 
(*320*) ('6','ìáÖã'        ,'ìáãõ'        ), 
(*321*) ('2','ìäÄáÄçàÖ'    ,'ìäÄáÄçàü'    ),
(*322*) ('3','ìêçÄ'        ,'ìêçõ'        ),
(*323*) ('2','ìëíÄçéÇäÄ'   ,'ìëíÄçéÇäà'   ),
(*324*) ('2','ìíäÄ'        ,'ìíäà'        ),
(*325*) ('2','ìóÄëíéä'     ,'ìóÄëíäà'     ),
(*326*) ('2','ìóÖçàÖ'      ,'ìóÖçàü'      ),
(*327*) ('2','îÄåàãàü'     ,'îÄåàãàà'     ),
(*328*) ('2','îÖêåÄ'       ,'îÖêåõ'       ),
(*329*) ('2','îàÉìêÄ'      ,'îàÉìêõ'      ),
(*330*) ('2','îÖêåÄ'       ,'îÖêåõ'       ),
(*331*) ('2','îàÉìêÄ'      ,'îàÉìêõ'      ),
(*332*) ('2','îàçäÄ'       ,'îàçäà'       ),
(*333*) ('1','îéêåÄ'       ,'îéêåõ'       ),
(*334*) ('2','îêÄäñàü'     ,'îêÄäñàà'     ),
(*335*) ('2','îìçäñàü'     ,'îìçäñàà'     ),
(*336*) ('3','ïÄêÄäíÖêàëíàäÄ','ïÄêÄäíÖêàëíàäà'),
(*337*) ('3','ïÇéëí'       ,'ïÇéëíõ'      ), 
(*338*) ('2','ïéïéã'       ,'ïéïãõ'       ),
(*339*) ('2','ñÖãú'        ,'ñÖãà'        ),
(*340*) ('2','ñÖèéóäÄ'     ,'ñÖèéóäà'     ),
(*341*) ('2','ñÖêäéÇú'     ,'ñÖêäÇà'      ),
(*342*) ('2','ñàîêÄ'       ,'ñàîêõ'       ),
(*343*) ('2','óÄâçàä'      ,'óÄâçàäà'     ), 
(*344*) ('2','óÄëíàñÄ'     ,'óÄëíàñõ'     ),
(*345*) ('2','óÄëíú'       ,'óÄëíà'       ),
(*346*) ('2','óÄòÖóäÄ'     ,'óÄòÖóäà'     ),
(*347*) ('3','óÖãçéä'      ,'óÖãçéäà'     ),
(*348*) ('1','óÖêÇú'       ,'óÖêÇà'       ),
(*349*) ('2','óàç'         ,'óàçõ'        ),
(*350*) ('2','óàëãé'       ,'óàëãÄ'       ),
(*351*) ('3','óãÖç'        ,'óãÖçõ'       ), 
(*352*) ('2','òÄÉ'         ,'òÄÉà'        ), 
(*353*) ('2','òÄâÅÄ'       ,'òÄâÅõ'       ),
(*354*) ('2','òÄâäÄ'       ,'òÄâäà'       ),
(*355*) ('3','òàçÄ'        ,'òàçõ'        ),
(*356*) ('2','òàè'         ,'òàèõ'        ), 
(*357*) ('4','òàòäÄ'       ,'òàòäà'       ),
(*358*) ('2','òäéãÄ'       ,'òäéãõ'       ),
(*359*) ('2','òíÄåè'       ,'òíÄåèõ'      ), 
(*360*) ('2','òíÄí'        ,'òíÄíõ'       ), 
(*361*) ('3','ôàí'         ,'ôàíõ'        ), 
(*362*) ('2','ùäàèÄÜ'      ,'ùäàèÄÜà'     ), 
(*363*) ('3','ùãÖåÖçí'     ,'ùãÖåÖçíõ'    ), 
(*364*) ('2','ùçÖêÉÖíàä'   ,'ùçÖêÉÖíàäà'  ), 
(*365*) ('2','ùòÖãéç'      ,'ùòÖãéçõ'     ) );  

  VAR
    CODE,
    I, J, K, CUR, Q, PAIRSAMT, P0, PH, P0J, PHJ, 
      LI, LJ, BN_REACHED : LONGINT;
    INP, OUT : TEXT;
    LINE, TMP_TKN, STEM : STR115;
    BUNCH : ARRAY [0..MAX] OF
      RECORD
        NUMIND : INTEGER;
        NAME : STR45;
      END;
    LC, LQ : INTEGER;
    FOUND, TO_REVERSE : BOOLEAN;
    BSNCLS : ARRAY [1..MAXBSN, 1..2] OF INTEGER;{ basic noun classes }
    BSNPAR : ARRAY [1..MAXBSN, 1..2] OF INTEGER;{ basic noun numbs and gends }
    BSNSTR : ARRAY [1..MAXBSN] OF STR115;     { basic noun strings }
    TOKI, TOKJ, TAILI, TAILJ : STR45;
    FINI, FINJ : STR5;
    FI2, FJ2 : STR3;
    FI1, FJ1 : CHAR;


{ Listing of false SINGL-PLUR pairs}
FUNCTION FORBID_PAIR (TOK1, TOK2 : STR115) : BOOLEAN;
       (*===========*)
CONST 
  FORBID_MAX = 232;
  T : ARRAY [1..FORBID_MAX, 1..2] OF STR45 =
(('ÄçÄãéÉà','ÄçÄãéÉàà'),
 ('ÄçÄãàíàä','ÄçÄãàíàäÄ'),
 ('ÄçÄãàíàäÄ','ÄçÄãàíàäà'),
 ('ÄçíàëÖèíàä','ÄçíàëÖèíàäÄ'),
 ('ÄçíàëÖèíàäÄ','ÄçíàëÖèíàäà'),
 ('Äëíêéîàáàä','ÄëíêéîàáàäÄ'),
 ('ÄëíêéîàáàäÄ','Äëíêéîàáàäà'),
 ('ÅÄáàãàä','ÅÄáàãàäÄ'),
 ('ÅÄáàãàä','ÅÄáàãàäà'),
 ('ÅÄêÑ','ÅÄêÑÄ'),
 ('ÅÄêàç','ÅÄêõ'),
 ('ÅÄêä','ÅÄêäÄ'),
 ('ÅÖÉìç','ÅÖÉìçúü'),
 ('Åéãíìç','Åéãíìçúü'),
 ('ÅêÖÑÖçú','ÅêÖÑçà'),
 ('ÅêÖçÑ','ÅêÖçÑà'),
 ('Åìê','Åìêà'),
 ('ÅìêÄ','Åìêà'),
 ('ÅìêÄ','Åìêõ'),
 ('ÇÄíÄ','ÇÄíàç'),
 ('ÇÖä','ÇÖäà'),
 ('ÇÖëí','ÇÖëíà'),
 ('Çéêéç','ÇéêéçÄ'),
 ('Çéêóìç','Çéêóìçúü'),
 ('ÇõÅéê','ÇõÅéêõ'),
 ('ÉÖéèéãàíàä','ÉÖéèéãàíàäÄ'),
 ('ÉÖéèéãàíàäÄ','ÉÖéèéãàíàäà'),
 ('ÉÖêéàç','ÉÖêéàçà'),
 ('ÉãéÅìãÄ','ÉãéÅìãàç'),
 ('ÉéÇéêìç','ÉéÇéêìçúü'),
 ('Ééãúî','Ééãúîõ'),
 ('Ééëí','Ééëíà'),
 ('Ééëíú','Ééëíúà'),
 ('Ééëíú','Ééëíúü'),
 ('ÉêÄîÄ','ÉêÄîàç'),
 ('Éêìáàç','Éêìáõ'),
 ('ÑÖíÖêåàçÄçí','ÑÖíÖêåàçÄçíÄ'),
 ('ÑàÄãÖäíàä','ÑàÄãÖäíàäÄ'),
 ('ÑàÄãÖäíàäÄ','ÑàÄãÖäíàäà'),
 ('ÑàçÄåàä','ÑàçÄåàäÄ'),
 ('ÑàçÄåàäÄ','ÑàçÄåàäà'),
 ('ÑéÉåÄíàä','ÑéÉåÄíàäÄ'),
 ('ÑéÉåÄíàäÄ','ÑéÉåÄíàäà'),
 ('Ñéã','Ñéãà'),
 ('Ñìò','ÑìòÄ'),
 ('ÜÄê','ÜÄêÄ'),
 ('áÄçÄÇÖë','áÄçÄÇÖëà'),
 ('âéÉ','âéÉÄ'),
 ('âéÉÄ','âéÉà'),
 ('äãÄëëàä','äãÄëëàäÄ'),
 ('äãÄëëàäÄ','äãÄëëàäà'),
 ('äéã','äéãÄ'),
 ('äéãÑìç','äéãÑìçúü'),
 ('äéããÖÉà','äéããÖÉàà'),
 ('äéå','äéåÄ'),
 ('äéåèéáàí','äéåèéáàíÄ'),
 ('äéç','äéçà'),
 ('äéèà','äéèàà'),
 ('äêÖè','äêÖèà'),
 ('äêàíàä','äêàíàäÄ'),
 ('äêàíàäÄ','äêàíàäà'),
 ('äêéÇ','äêéÇà'),
 ('äêéç','äêéçõ'),
 ('ãÖÑ','ãÖÑà'),
 ('ãàë','ãàëÄ'),
 ('ãàêàä','ãàêàäÄ'),
 ('ãàêàäÄ','ãàêàäà'),
 ('ãéÉàä','ãéÉàäÄ'),
 ('ãéÉàäÄ','ãéÉàäà'),
 ('ãûÑ','ãûÑà'),
 ('åÖã','åÖãà'),
 ('åÄçÖê','åÄçÖêÄ'),
 ('åÄçÖê','åÄçÖêõ'),
 ('åÄíÖåÄíàä','åÄíÖåÄíàäÄ'),
 ('åÄíÖåÄíàäÄ','åÄíÖåÄíàäà'),
 ('åéçÄêïà','åéçÄêïàà'),
 ('åÄíÖêà','åÄíÖêàà'),
 ('åàÑà','åàÑàà'),
 ('åéêÖçÄ','åéêü'),
 ('çÄñà','çÄñàà'),
 ('éèÄã','éèÄãÄ'),
 ('éèíàä','éèíàäÄ'),
 ('éèíàäÄ','éèíàäà'),
 ('éëíêéÉ','éëíêéÉÄ'),
 ('éíÖã','éíÖãà'),
 ('éíêìÅ','éíêìÅà'),
 ('èÄ','èÄà'),
 ('èÄêà','èÄêàà'),
 ('èàêéÉ','èàêéÉÄ'),
 ('èàä','èàäÄ'),
 ('èãÄíé','èãÄíúü'),
 ('èãüëìç','èãüëìçúü'),
 ('èéÉéç','èéÉéçà'),
 ('èéÑÇéÑ','èéÑÇéÑÄ'),
 ('èéãàíàä','èéãàíàäÄ'),
 ('èéãàíàäÄ','èéãàíàäà'),
 ('èéãéÉ','èéãéáúü'),
 ('èéãõçú','èéãõçúà'),
 ('èéè','èéèÄ'),
 ('èêÄÉåÄíàä','èêÄÉåÄíàäÄ'),
 ('èêÄÉåÄíàäÄ','èêÄÉåÄíàäà'),
 ('èêÄäíàä','èêÄäíàäÄ'),
 ('èêÄäíàäÄ','èêÄäíàäà'),
 ('èêÖëë','èêÖëëÄ'),
 ('èêéÇéÑ','èêéÇéÑõ'),
 ('èêéÖå','èêéâåõ'),
 ('èìã','èìãà'),
 ('èìêèìê','èìêèìêÄ'),
 ('êÄÅ','êÄÅÄ'),
 ('êÖÇ','êÖÇÄ'),
 ('êÖá','êÖáà'),
 ('êàëä','êàëäÄ'),
 ('êéåÄçíàä','êéåÄçíàäÄ'),
 ('êéåÄçíàäÄ','êéåÄçíàäà'),
 ('êéí','êéíÄ'),
 ('êéí','êéíõ'),
 ('ëÄç','ëÄçà'),
 ('ëÄïÄêÄ','ëÄïÄêàç'),
 ('ëÖåú','ëÖåúà'),
 ('ëÖçúéê','ëÖçúéêÄ'),
 ('ëàçúéê','ëàçúéêÄ'),
 ('ëíÄíú','ëíÄíúà'),
 ('ëíàïà','ëíàïàà'),
 ('ëíêÄíÖÉà','ëíêÄíÖÉàà'),
 ('ëìèêìÉ','ëìèêìÉÄ'),
 ('íéãä','íéãäà'),
 ('íéè','íéèà'),
 ('íêÖëä','íêÖëäÄ'),
 ('íêàÅìç','íêàÅìçÄ'),
 ('îÄí','îÄíÄ'),
 ('îàáàä','îàáàäÄ'),
 ('îàáàäÄ','îàáàäà'),
 ('ïÇéêéëí','ïÇéêéëíà'),
 ('ñÇÖí','ñÇÖíõ'),
 ('óÖêí','óÖêíõ'),
 ('ÄÑêÖëÄ','ÄÑêÖëõ'),
 ('ÄåÅêÄ','ÄåÅêÖ'),
 ('ÅÄêÑÄ','ÅÄêÑõ'),
 ('ÅìêÜìÄ','ÅìêÜìà'),
 ('ÇÄãÖä','ÇÄãäà'),
 ('ÇÖÖê','ÇÖêõ'),
 ('ÇÖäÄ','ÇÖäà'),
 ('ÇÖäÄ','ÇÖäé'),
 ('ÇÖëÄ','ÇÖëà'),
 ('ÇÖëÄ','ÇÖëõ'),
 ('ÉÖéèéãàíàä','ÉÖéèéãàíàäÄ'),
 ('ÉÖéèéãàíàäÄ','ÉÖéèéãàíàäà'),
 ('ÉéêÄ','ÉéêÖ'),
 ('ÉêìÑÄ','ÉêìÑà'),
 ('ÑÄ','Ñé'),
 ('ÑàÇÄ','ÑàÇé'),
 ('ÑàçÄåàä','ÑàçÄåàäÄ'),
 ('ÑàçÄåàäÄ','ÑàçÄåàäà'),
 ('Ñçà','Ñçé'),
 ('ÑéÉåÄíàä','ÑéÉåÄíàäÄ'),
 ('ÑéÉåÄíàäÄ','ÑéÉåÄíàäà'),
 ('Ñìòäà','Ñìòéä'),
 ('ÜÄê','ÜÄêÄ'),
 ('ÜÖãÖáÄ','ÜÖãÖáé'),
 ('âéÉ','âéÉÄ'),
 ('âéÉÄ','âéÉà'),
 ('äÄáçÄ','äÄáçà'),
 ('äÄêÄ','äÄêÖ'),
 ('äÄêÄäìãà','äÄêÄäìãú'),
 ('äéãÄ','äéãõ'),
 ('äéãúÖ','äéãúü'),
 ('äéã','äéãÄ'),
 ('äéòÖãÖä','äéòÖãäà'),
 ('äêàíàä','äêàíàäÄ'),
 ('äêàíàäÄ','äêàíàäà'),
 ('ãÄÉÖêà','ãÄÉÖêü'),
 ('ãÄèíÄ','ãÄèíà'),
 ('ãÖÅÖÑÄ','ãÖÅÖÑà'),
 ('ãàêàä','ãàêàäÄ'),
 ('ãàêàäÄ','ãàêàäà'),
 ('ãéÉàä','ãéÉàäÄ'),
 ('ãéÉàäÄ','ãéÉàäà'),
 ('ãéÜà','ãéÜú'),
 ('åÄíÖåÄíàä','åÄíÖåÄíàäÄ'),
 ('åÄíÖåÄíàäÄ','åÄíÖåÄíàäà'),
 ('åÖïÄ','åÖïà'),
 ('åéãéäà','åéãéäé'),
 ('åéôà','åéôú'),
 ('éäéêäà','éäéêéä'),
 ('éëÄÑäÄ','éëÄÑäà'),
 ('éëÄ','éëà'),
 ('éëéÅÄ','éëéÅà'),
 ('èÄêà','èÄêàà'),
 ('èÄêà','èÄêü'),
 ('èÄëíÄ','èÄëíà'),
 ('èÄ','èà'),
 ('èÖçÖä','èÖçäà'),
 ('èÖçà','èÖçú'),
 ('èÖçúäÄ','èÖçúäà'),
 ('èÖëçú','èÖëçü'),
 ('èàäÄ','èàäÖ'),
 ('èàêéÉÄ','èàêéÉà'),
 ('èéãàíàä','èéãàíàäÄ'),
 ('èéãàíàäÄ','èéãàíàäà'),
 ('èéêäà','èéêéä'),
 ('èêÄÉåÄíàä','èêÄÉåÄíàäÄ'),
 ('èêÄÉåÄíàäÄ','èêÄÉåÄíàäà'),
 ('èêÖëëÄ','èêÖëëõ'),
 ('èêéÇéÑÄ','èêéÇéÑõ'),
 ('èìëíõçú','èìëíõçü'),
 ('èìòäà','èìòéä'),
 ('êÄÅÄ','êÄÅõ'),
 ('êÄäÄ','êÄäà'),
 ('êéÜà','êéÜú'),
 ('ëÖãÄ','ëÖãà'),
 ('ëÖãà','ëÖãé'),
 ('ëÖåú','ëÖåü'),
 ('ëÖçà','ëÖçé'),
 ('ëÖçà','ëÖçú'),
 ('ëéãà','ëéãé'),
 ('ëéèãÄ','ëéèãà'),
 ('ëéèãà','ëéèãé'),
 ('ëìèêìÉ','ëìèêìÉÄ'),
 ('ëìòÄ','ëìòà'),
 ('ëóÖíÄ','ëóÖíõ'),
 ('íÖíêÄ','íÖíêõ'),
 ('íÖíêÄÑÄ','íÖíêÄÑà'),                         	
 ('íéãä','íéãäà'),
 ('íéêåéáÄ','íéêåéáõ'),
 ('íìò','íìòà'),                              	
 ('íìòà','íìòú'),                              	
 ('ìïÄ','ìïé'),
 ('îàáàä','îàáàäÄ'),
 ('îàáàäÄ','îàáàäà'),
 ('ïÇÄëíìç','ïÇÄëíìçúü'),
 ('ñÇÖíÄ','ñÇÖíõ'),
 ('ôÖãäà','ôÖãéä'));
VAR 
  I : INTEGER; 
  FOUND : BOOLEAN;
BEGIN
  FOUND := FALSE;
  I := 0;
  REPEAT 
    INC(I); 
    FOUND := (TOK1 = T[I,1]) AND (TOK2 = T[I,2]);
  UNTIL FOUND OR (I = FORBID_MAX);
  FORBID_PAIR := FOUND;
END;

	{ Initialization of basic nouns array }
PROCEDURE FILL_BASE_NOUNS;
        (*===============*)
VAR
  I : LONGINT;
  ERC1, ERC2 : INTEGER;
  LINE : STR115;
  INP : TEXT;

BEGIN
  ASSIGN (INP, 'BASICS.LST');
  RESET (INP);
  I := 0;
  REPEAT
    READLN (INP, LINE);
    INC(I);
    ERC1 := 0;
    ERC2 := 0;
    VAL (COPY(LINE,2,4), BSNCLS [I,1], ERC1);
    VAL (COPY(LINE,6,4), BSNCLS [I,2], ERC2);
    IF ERC1 + ERC2 > 0
      THEN WRITELN ('Conversion error at line ', I, ' of BASICS.LST');
    BSNPAR [I,1] := ORD(LINE [11]) - ORD('0');
    BSNPAR [I,2] := ORD(LINE [13]) - ORD('0');
    BSNSTR [I] := COPY (LINE, 15, LENGTH(LINE)-14);
  UNTIL EOF(INP) OR (I = MAXBSN);
  BN_REACHED := I;
  CLOSE (INP);
  writeln ('BASICS are ', BN_REACHED);
END;

FUNCTION REVERSABLE_0 (NUM : INTEGER) : BOOLEAN;
       (*============*)
CONST
  REVERS0 : ARRAY [1..13] OF INTEGER =
    (2,3,6,7,9,15,16,17,18,19,20,21,22);
VAR 
  I : INTEGER; 
  FOUND : BOOLEAN;
BEGIN
  FOUND := FALSE;
  I := 0;
  REPEAT 
    INC(I); 
    FOUND := (NUM = REVERS0[I]);
  UNTIL FOUND OR (I = 13);
  REVERSABLE_0 := FOUND;
END;

FUNCTION REVERSABLE_1 (NUM : INTEGER) : BOOLEAN;
       (*============*)
CONST
  REVERS1 : ARRAY [1..9] OF INTEGER =
    (6,7,8,10,12,17,20,24,25);
VAR 
  I : INTEGER; 
  FOUND : BOOLEAN;
BEGIN
  FOUND := FALSE;
  I := 0;
  REPEAT 
    INC(I); 
    FOUND := (NUM = REVERS1[I]);
  UNTIL FOUND OR (I = 9);
  REVERSABLE_1 := FOUND;
END;

BEGIN  (* MAIN *)
  FILL_BASE_NOUNS;

  ASSIGN (INP, 'OPFUNC_0.LST');
  RESET (INP);
  ASSIGN (OUT, 'PAIRS3.DAT');
  REWRITE (OUT);

   { Single-word declinable pairs gathered }
  WRITELN ('FILE OPFUNC_0.LST BEING PROCESSED: 1st scan');

  FOR I := 0 TO MAX DO
    WITH BUNCH [I] DO
      BEGIN
        NUMIND := 0;
        NAME := DUMMY;
      END;

  PAIRSAMT := 0;
  CUR := - 1;

  REPEAT
    READLN (INP, LINE);
    VAL (COPY (LINE, 7, 3), K, CODE);
    IF (LINE [15] <> '^') AND (POS ('<', LINE) = 0) AND (K = 255)
      THEN
        BEGIN
          CUR := SUCC(CUR) MOD (MAX+1);
          BUNCH [CUR].NUMIND := ORD (LINE [11]) - ORD ('0');
          BUNCH [CUR].NAME := COPY (LINE, 15, LENGTH (LINE) - 14);

          LC := LENGTH (BUNCH [CUR].NAME);
          STEM := COPY (BUNCH [CUR].NAME, 1, LC - 3);
          FOUND := FALSE;
          I := 0;

          REPEAT
            TO_REVERSE := FALSE;
            INC(I);
            Q := (MAX+1+CUR-I) MOD (MAX+1);
            LQ := LENGTH (BUNCH [Q].NAME);
            CASE ABS (LC - LQ) OF
              0 :
                BEGIN
                  K := 0;
                  REPEAT
                    INC(K);
                    TMP_TKN := COPY (BUNCH [Q].NAME, 1,
                      LQ - LENGTH (NUMB_PAIRS0 [K, 1])) + NUMB_PAIRS0 [K, 2];
                    FOUND := (COPY (BUNCH [Q].NAME,
                      LQ - LENGTH (NUMB_PAIRS0 [K, 1]) + 1,
                      LENGTH (NUMB_PAIRS0 [K, 1])) = NUMB_PAIRS0 [K, 1])
                      AND (TMP_TKN = BUNCH [CUR].NAME)
                      AND (BUNCH [CUR].NUMIND = 3 - BUNCH [Q].NUMIND)

                      AND NOT ((COPY (BUNCH [CUR].NAME,
                        LENGTH (BUNCH [CUR].NAME) - 2, 3) = 'àäà')
                      AND (COPY (BUNCH [Q].NAME,
                        LENGTH (BUNCH [Q].NAME) - 2, 3) = 'àäÄ')
                      AND (STEM <> 'äãàç') AND (STEM <> 'åÖíéÑ')
                      AND (STEM <> 'êÖèã') AND (STEM <> 'êìÅê')
                      AND (STEM <> 'ïÄêÄäíÖêàëí'))
                      AND ((K <> 20) OR (TMP_TKN <> 'ìêéç'))
                      AND ((K <> 16) OR
                        ((TMP_TKN <> 'êéÜú') AND (TMP_TKN <> 'èÖçú')))
                      AND ((K <> 15) OR (TMP_TKN <> 'Ñçé'))
                      AND ((K <> 14) OR (TMP_TKN <> 'áåÖâ'))
                      AND ((K <> 4) OR (TMP_TKN <> 'ÑõÅõ'))
                      AND ((K <> 1) OR
                        ((TMP_TKN <> 'çéëäà') AND (TMP_TKN <> 'éëÄÑäà')
                      AND (TMP_TKN <> 'óÖäà')));
                  UNTIL FOUND OR (K = MAX0);
                  TO_REVERSE := REVERSABLE_0 (K);
                END;
              1..4 :
                BEGIN
                  K := 0;
                  REPEAT
                    INC (K);
                    TMP_TKN := COPY (BUNCH [Q].NAME, 1,
                      LQ - LENGTH (NUMB_PAIRS1[K, 1])) + NUMB_PAIRS1[K, 2];
                    FOUND := (COPY (BUNCH [Q].NAME,
                      LQ - LENGTH (NUMB_PAIRS1[K, 1]) + 1,
                      LENGTH (NUMB_PAIRS1[K, 1])) = NUMB_PAIRS1[K, 1])
                      AND (TMP_TKN = BUNCH [CUR].NAME)
                      AND (BUNCH [CUR].NUMIND = 3 - BUNCH [Q].NUMIND)
                      AND ((K <> 3) OR
                      ( (TMP_TKN <> 'ãÄÑõ') AND (TMP_TKN <> 'éèÖêõ') ))
                      AND ((K <> 2) OR (TMP_TKN <> 'ëÄçà')  )
                      AND ((K <> 1) OR
                      ((TMP_TKN <> 'ÇéêéíÄ') AND (TMP_TKN <> 'ãÖíÄ')
                      AND (TMP_TKN <> 'ëìÑÄ') AND (TMP_TKN <> 'óÄÑÄ')));
                  UNTIL FOUND OR (K = MAX1);
                  TO_REVERSE := REVERSABLE_1 (K);
                END;
              ELSE ;
            END;

            IF FOUND AND NOT FORBID_PAIR (BUNCH [Q].NAME, BUNCH [CUR].NAME) 
              THEN
                BEGIN
                  IF TO_REVERSE
                    THEN
            WRITELN (OUT, '1 ', BUNCH [CUR].NAME, BL:2, BUNCH [Q].NAME)
                     ELSE
            WRITELN (OUT, '1 ', BUNCH [Q].NAME, BL:2, BUNCH [CUR].NAME);
                  INC (PAIRSAMT);
                END;
          UNTIL FOUND OR (I = MAX);
        END;
  UNTIL EOF (INP);
  CLOSE (INP);

   { Single-word indeclinable pairs gathered }
  FOR I := 1 TO MAX_NOINCL DO
    BEGIN
      WRITELN (OUT, '1 ', NOINCL[I], '1', BL:2, NOINCL[I], '2');
      INC (PAIRSAMT);
    END;

   { Single-word rare declinable pairs gathered }
  FOR I := 1 TO ADD_MAX DO
    BEGIN
      WRITELN (OUT, '1 ', ADD_PAIRS [I,1], BL:2, ADD_PAIRS [I,2]);
      INC (PAIRSAMT);
    END;

   { Single-word homonymous mumbered pairs gathered }
  FOR I := 1 TO NUMERD_MAX DO
    BEGIN
      K := ORD(NUM_PAIRS[I,0,1]) - ORD('0');
      FOR J := 1 TO K DO
        BEGIN
          WRITELN (OUT, '1 ', NUM_PAIRS [I,1] + CHR (ORD('0')+J) , 
            BL:2, NUM_PAIRS [I,2] + CHR (ORD('0')+J));
          INC (PAIRSAMT);
        END;
    END;


{---------------------------------------------------}

   { Multi-word pairs gathered }
  WRITELN ('FILE OPFUNC_0.LST BEING PROCESSED: 2nd scan');

  FOR I := 1 TO BN_REACHED - 1 DO
    BEGIN
      IF (BSNCLS [I,2] <> 255) AND (POS(BSNSTR [I,1], '123456789') = 0)
        THEN 
          BEGIN
            LI := LENGTH (BSNSTR [I]);
            P0 := POS (BL, BSNSTR [I]);
            PH := POS (HY, BSNSTR [I]);
            IF PH > 0
              THEN
                BEGIN
                  TOKI := COPY (BSNSTR [I], 1, PH-1);
                  TAILI := COPY (BSNSTR [I], PH+1, LI-PH);
                  FINI := COPY (BSNSTR [I], PH+1, 3); 
                END
            ELSE IF P0 > 0
              THEN
                BEGIN
                  TOKI := COPY (BSNSTR [I], 1, P0-1);
                  TAILI := COPY (BSNSTR [I], P0+1, LI-P0);
                  FINI := COPY (BSNSTR [I], P0+1, 3); 
                END
            ELSE WRITELN ('Something wrong with ', BSNSTR [I]);

            J := I;
            FOUND := FALSE;
            REPEAT
              INC(J);
              IF BSNCLS [J,2] <> 255
                THEN 
                  BEGIN
                    LJ := LENGTH (BSNSTR [J]);
                    P0J := POS (BL, BSNSTR [J]);
                    PHJ := POS (HY, BSNSTR [J]);
                    IF PHJ > 0
                      THEN
                        BEGIN
                          TOKJ := COPY (BSNSTR [J], 1, PHJ-1);
                          TAILJ := COPY (BSNSTR [J], PHJ+1, LJ-PHJ);
                          FINJ := COPY (BSNSTR [J], PHJ+1, 3); 
                        END
                    ELSE IF P0J > 0
                      THEN
                        BEGIN
                          TOKJ := COPY (BSNSTR [J], 1, P0J-1);
                          TAILJ := COPY (BSNSTR [J], P0J+1, LJ-P0J);
                          FINJ := COPY (BSNSTR [J], P0J+1, 3); 
                        END
                    ELSE WRITELN ('Something wrong with ', BSNSTR [I]);

                    FOUND := 
                      ( (COPY (TOKI, 1, LENGTH (TOKI)-2) =
                        COPY (TOKJ, 1, LENGTH (TOKJ)-2))
                        OR (TOKJ = TOKI+'Ä') OR (TOKJ = TOKI+'à') 
                        OR (TOKJ = TOKI+'õ') ) 
                      AND ( (BSNCLS [I,2] <> 0) AND (BSNCLS [J,2] <> 0) 
                          AND (FINI = FINJ) 
                          AND (ABS (LENGTH (TAILI) - LENGTH (TAILJ)) < 3)
                        OR ( (BSNCLS [I,2] = 0) AND (BSNCLS [J,2] = 0) 
                          AND (( TAILI = TAILJ) 
           {!4!}            OR (COPY(TAILI,1,4) = (COPY(TAILJ,1,4))))  )) 
                      AND (BSNPAR [I,1] <> BSNPAR [J,1])
                      AND NOT (BSNSTR [I] = 'çÄìóçé-íÖïçàóÖëäÄü àçíÖããàÉÖçñàü')
                      AND NOT (BSNSTR [I] = 'çÄìóçé-íÖïçàóÖëäÄü àçîéêåÄñàü')
                      AND NOT (BSNSTR [I] = 'çÄìóçé-íÖïçàóÖëäÄü êÖÇéãûñàü')
                      AND NOT ((BSNSTR [I] = 'ÑÄóçõÖ ÑéåÄ')
                        AND (BSNSTR [J] = 'ÑÄóçõâ Ñéåàä'))
                      AND NOT ((BSNSTR [I] = 'ÇëÖ êÄáçéÇàÑçéëíà')
                        AND (BSNSTR [J] = 'ÇëÖ êÄáçééÅêÄáàÖ'))
                      AND NOT ((BSNSTR [I] = 'çÄãéÉéÇÄü àçëèÖäñàü')
                        AND (BSNSTR [J] = 'çÄãéÉéÇõÖ àçëèÖäíéêÄ'));
   
                    IF FOUND
                      THEN 
                        BEGIN
                          FI1 := TOKI[LENGTH(TOKI)];
                          FJ1 := TOKJ[LENGTH(TOKJ)];
                          FI2 := COPY(TOKI,LENGTH(TOKI)-1,2);
                          FJ2 := COPY(TOKJ,LENGTH(TOKJ)-1,2);
                          IF (FI2 = 'õÖ') OR (FI2 = 'àÖ')
                            OR ((FI2 = 'äà') AND (FJ2 = 'éä'))
                            OR ((FI1 = 'Ä') AND (FJ1 = 'é'))
                            OR ((FI1 = 'à') AND (FJ1 = 'ú'))
                            OR ((FI1 = 'à') AND (FJ1 = 'ü'))
                           {OR ((FI1 = 'ü') AND (FJ1 = 'Ö'))
                            OR ((FI1 = 'ü') AND (FJ1 = 'à')) }
                            THEN WRITELN (OUT, '1 ', BSNSTR [J], BL:2, BSNSTR [I])                        
                            ELSE WRITELN (OUT, '1 ', BSNSTR [I], BL:2, BSNSTR [J]);
                          INC (PAIRSAMT);
                        END;
                  END;
            UNTIL FOUND OR (J = BN_REACHED) OR (J = I + 45)
          END;
    END; 
  
  FLUSH (OUT);

  WRITELN ('File PAIRS3.DAT contains ', PAIRSAMT, ' pairs');
END.
