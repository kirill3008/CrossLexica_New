PROGRAM GETPARTI;

  CONST
    BL = ' ';
    DUMMY = '';
    MAXVERB = 289;
    CLASSES3 : ARRAY [1..MAXVERB, 1..3] OF STRING [12] =
(*  1*)(('‡€’','‡€‚‰','†“™‰'),
(*  2*) ('‡€’‘','‡€‚‰‘','†“™‰‘'),
(*  3*) ('’','‚‰','™‰'),
(*  4*) ('’‘','‚‰‘','™‰‘'),
(*  5*) ('“’‘','‰‘','“™‰‘'),
(*  6*) ('‰’','…„‰','‰„“™‰'),
(*  7*) ('’','‚‰','™‰'),
(*  8*) ('’‘','‚‰‘','™‰‘'),
(*  9*) ('’€’‘','’€‚‰‘','“™‰‘'),
(* 10*) ('“’','‰','“™‰'),
(* 11*) ('‘’','‰','“™‰'),
(* 12*) ('€’‘','€‚‰‘','“™‰‘'),
(* 13*) ('‰’‘','…„‰‘','‰„“™‰‘'),
(* 14*) ('’','‚‰','€™‰'),
(* 15*) ('’‘','‚‰‘','€™‰‘'),
(* 16*) ('“’','“‚‰','“™‰'),
(* 17*) ('’‘','‰‘','“™‰‘'),
(* 18*) ('—','‰','“™‰'),
(* 19*) ('›’','›‚‰','“„“™‰'),
(* 20*) ('†€’','†€‚‰','ƒ“™‰'),
(* 21*) ('—‘','‰‘','“™‰‘'),
(* 22*) ('’','‚‰','„“™‰'),
(* 23*) ('—‘','ƒ‰‘','ƒ“™‰‘'),
(* 24*) ('’‘','‚‰‘','„“™‰‘'),
(* 25*) ('‘’','‚‰','„™‰'),
(* 26*) ('…—','…ƒ‰','ƒ“™‰'),
(* 27*) ('—','ƒ‰','ƒ“™‰'),
(* 28*) ('…—‘','…ƒ‰‘','ƒ“™‰‘'),
(* 29*) ('‘’‘','‚‰‘','„™‰‘'),
(* 30*) ('‚€’','‚€‚‰','“™‰'),
(* 31*) ('…‚€’','…‚€‚‰','™‰'),
(* 32*) ('€’','€‚‰','‹™‰'),
(* 33*) ('’','‚‰','™‰'),
(* 34*) ('‚€’‘','‚€‚‰‘','“™‰‘'),
(* 35*) ('…‚€’‘','…‚€‚‰‘','™‰‘'),
(* 36*) ('€’‘','€‚‰‘','‹™‰‘'),
(* 37*) ('’‘','‚‰‘','™‰‘'),
(* 38*) ('’‘','‚‰‘','™‰‘'),
(* 39*) ('…‚€’','…‚€‚‰','“™‰'),
(* 40*) ('’','‚‰','…™‰'),
(* 41*) ('…’','…‚‰','™‰'),
(* 42*) ('‘’','„‰','„‰'),
(* 43*) ('’','‚‰','™‰'),
(* 44*) ('…‘’‘','…’‰‘','’“™‰‘'),
(* 45*) ('…‘’','…’‰','’“™‰'),
(* 46*) ('……’','…‰','“™‰'),
(* 47*) ('’','‰','“™‰'),
(* 48*) ('€‘’','‘‰','€‘’“™‰'),
(* 49*) ('’','‰','“™‰'),
(* 50*) ('’‘','‰‘','“™‰‘'),
(* 51*) ('€‘’‘','‘‰‘','€‘’“™‰‘'),
(* 52*) ('’‘','‰‘','“™‰‘'),
(* 53*) ('“’‘','“‚‰‘','“‚‰‘'),
(* 54*) ('‘’','’‰','’“™‰'),
(* 55*) ('‘’‘','’‰‘','’“™‰‘'),
(* 56*) ('€’','€‚‰','…“™‰'),
(* 57*) ('€’‘','€‚‰‘','…“™‰‘'),
(* 58*) ('‘’‘','„‰‘','„“™‰‘'),
(* 59*) ('‘€’','‘€‚‰','“™‰'),
(* 60*) ('€’','€‚‰','“™‰'),
(* 61*) ('‘’','‚‰','„“™‰'),
(* 62*) ('‘’‘','‚‰‘','„“™‰‘'),
(* 63*) ('……’‘','…‰‘','“™‰‘'),
(* 64*) ('’','‚‰','“™‰'),
(* 65*) ('’‘','‚‰‘','“™‰‘'),
(* 66*) ('’','‚‰','“™‰'),
(* 67*) ('’‘','‚‰‘','“™‰‘'),
(* 68*) ('’','‚‰','‰“™‰'),
(* 69*) ('’‘','‚‰‘','‰“™‰‘'),
(* 70*) ('€’','€‚‰','™‰'),
(* 71*) ('‚€’','‚€‚‰','™‰'),
(* 72*) ('‡’','‡‚‰','‡“™‰'),
(* 73*) ('›’‘','›‚‰‘','“„“™‰‘'),
(* 74*) ('€’','€‚‰','“™‰'),
(* 75*) ('‚€’','‚€‚‰','‚“™‰'),
(* 76*) ('‘€’','‘€‚‰','™“™‰'),
(* 77*) ('’','‚‰','“™‰'),
(* 78*) ('…’','…‚‰','“™‰'),
(* 79*) ('…’‘','…‚‰‘','“™‰‘'),
(* 80*) ('‘’‘','‰‘','“™‰‘'),
(* 81*) ('’','‰','“™‰'),
(* 82*) ('…‚€’‘','…‚€‚‰‘','“™‰‘'),
(* 83*) ('‚€’‘','‚€‚‰‘','™‰‘'),
(* 84*) ('†€’‘','†€‚‰‘','ƒ“™‰‘'),
(* 85*) ('‚€’‘','‚€‚‰‘','‚“™‰‘'),
(* 86*) ('‘€’‘','‘€‚‰‘','“™‰‘'),
(* 87*) ('€’‘','€‚‰‘','“™‰‘'),
(* 88*) ('€’‘','€‚‰‘','™‰‘'),
(* 89*) ('‘€’‘','‘€‚‰‘','™“™‰‘'),
(* 90*) ('…’‘','…‚‰‘','™‰‘'),
(* 91*) ('’‘','‚‰‘','…™‰‘'),
(* 92*) ('’‘','‚‰‘','™‰‘'),
(* 93*) ('’','‚‰','‚“™‰'),
(* 94*) ('’‘','‚‰‘','‚“™‰‘'),
(* 95*) ('’‘','‚‰‘','“™‰‘'),
(* 96*) ('›’','›‚‰','™‰'),
(* 97*) ('›’‘','›‚‰‘','™‰‘'),
(* 98*) ('ƒ€’‘','ƒ€‚‰‘','†“™‰‘'),
(* 99*) ('‡€’‘','‡€‚‰‘','†“™‰‘'),
(*100*) ('€’‘','€‚‰‘','—“™‰‘'),
(*101*) ('„€’‘','„€‚‰‘','†“™‰‘'),
(*102*) ('‡€’','‡€‚‰','†“™‰'),
(*103*) ('€’','€‚‰','—“™‰'),
(*104*) ('„€’','„€‚‰','†“™‰'),
(*105*) ('’€’','’€‚‰','™“™‰'),
(*106*) ('’€’','’€‚‰','—“™‰'),
(*107*) ('ƒ€’','ƒ€‚‰','†“™‰'),
(*108*) ('’€’‘','’€‚‰‘','—“™‰‘'),
(*109*) ('•€’','•€‚‰','„“™‰'),
(*110*) ('•€’‘','•€‚‰‘','„“™‰‘'),
(*111*) ('€’','€‚‰','€™‰'),
(*112*) ('€’‘','€‚‰‘','€™‰‘'),
(*113*) ('†€’‘','†€‚‰‘','†“™‰‘'),
(*114*) ('’…’','’…‚‰','’™‰'),
(*115*) ('’…’‘','’…‚‰‘','’™‰‘'),
(*116*) ('’','‚‰','™‰'),
(*117*) ('’','‚‰','™‰'),
(*118*) ('’‘','‚‰‘','™‰‘'),
(*119*) ('†€’','†€‚‰','†“™‰'),
(*120*) ('’','‚‰','™‰'),
(*121*) ('’‘','‚‰‘','™‰‘'),
(*122*) ('‘‹€’','‘‹€‚‰','‹™‰'),
(*123*) ('‘‹€’‘','‘‹€‚‰‘','‹™‰‘'),
(*124*) ('„’','…„‰','„“™‰'),
(*125*) ('•€’','•€‚‰','“™‰'),
(*126*) ('‘’€’','‘’€‚‰','™“™‰'),
(*127*) ('‡’‘','‡‚‰‘','‡“™‰‘'),
(*128*) ('€’','€‚‰','“™‰'),
(*129*) ('€’‘','€‚‰‘','“™‰‘'),
(*130*) ('…’','…‚‰','€™‰'),
(*131*) ('’','‚‰','™‰'),
(*132*) ('’‘','‚‰‘','™‰‘'),
(*133*) ('‚’','‚‚‰','‚™‰'),
(*134*) ('‚’‘','‚‚‰‘','‚™‰‘'),
(*135*) ('‹’','‹‚‰','‹™‰'),
(*136*) ('‹’‘','‹‚‰‘','‹™‰‘'),
(*137*) ('’','‚‰','™‰'),
(*138*) ('’‘','‚‰‘','™‰‘'),
(*139*) ('’','‚‰','™‰'),
(*140*) ('’‘','‚‰‘','™‰‘'),
(*141*) ('…’','…‚‰','™‰'),
(*142*) ('…’‘','…‚‰‘','™‰‘'),
(*143*) ('…‘’','…‚‰','„“™‰'),
(*144*) ('…‘’‘','…‚‰‘','„“™‰‘'),
(*145*) ('…—','…ƒ‰','ƒ“™‰'),
(*146*) ('…—‘','…ƒ‰‘','ƒ“™‰‘'),
(*147*) ('•€’‘','•€‚‰‘','“™‰‘'),
(*148*) ('‘’€’‘','‘’€‚‰‘','™“™‰‘'),
(*149*) ('‘’','‚‰','“™‰'),
(*150*) ('‘’‘','‚‰‘','“™‰‘'),
(*151*) ('’','‚‰','“™‰'),
(*152*) ('’‘','‚‰‘','“™‰‘'),
(*153*) ('‰’','…„‰','„“™‰'),
(*154*) ('‰’‘','…„‰‘','„“™‰‘'),
(*155*) ('†…—','†…ƒ‰','†ƒ“™‰'),
(*156*) ('†…—‘','†…ƒ‰‘','†ƒ“™‰‘'),
(*157*) ('’……’','’…‰','’“™‰'),
(*158*) ('’……’‘','’…‰‘','’“™‰‘'),
(*159*) ('……’','…‰','“™‰'),
(*160*) ('……’‘','…‰‘','“™‰‘'),
(*161*) ('……’','…‰','“™‰'),
(*162*) ('……’‘','…‰‘','“™‰‘'),
(*163*) ('……’','…‰','“™‰'),
(*164*) ('€’','€‚‰','“™‰'),
(*165*) ('€’‘','‚‰','“™‰‘'),
(*166*) ('“’','“‚‰','“™‰'),
(*167*) ('‹€’','‹€‚‰','…‹™‰'),
(*168*) ('‹€’‘','‹€‚‰‘','…‹™‰‘'),
(*169*) ('†€’','†€‚‰','†“™‰'),
(*170*) ('€’','€‚‰','™‰'),
(*171*) ('€’‘','€‚‰‘','™‰‘'),
(*172*) ('’','‚‰','“™‰'),
(*173*) ('’‘','‚‰‘','“™‰‘'),
(*174*) ('„€’','„€‚‰','„…“™‰'),
(*175*) ('„€’‘','„€‚‰‘','„…“™‰‘'),
(*176*) ('—…‘’‘','—…‚‰‘','—’“™‰‘'),
(*177*) ('—…‘’','—…‚‰','—’“™‰'),
(*178*) ('ƒ€’‘','ƒ€‚‰‘','ƒ™‰‘'),
(*179*) ('ƒ€’','ƒ€‚‰','ƒ™‰'),
(*180*) ('—‘','ƒ‰‘','ƒ“™‰‘'),
(*181*) ('—','ƒ‰','ƒ“™‰'),
(*182*) ('‡‚€’‘','‡‚€‚‰‘','‡‚“™‰‘'),
(*183*) ('‡‚€’','‡‚€‚‰','‡‚“™‰'),
(*184*) ('€’‘','€‚‰‘','…“™‰‘'),
(*185*) ('€’','€‚‰','…“™‰'),
(*186*) ('ƒ€’','ƒ€‚‰','ƒ“™‰'),
(*187*) ('ƒ€’‘','ƒ€‚‰‘','ƒ“™‰‘'),
(*188*) ('…’','…‚‰','™‰'),
(*189*) ('‘—…‘’‘','‘—…‚‰‘','‡—’“™‰‘'),
(*190*) ('‘—…‘’','‘—…‚‰','‡—’“™‰'),
(*191*) ('‹’‘','‹‚‰‘','…‹™‰‘'),
(*192*) ('‹’','‹‚‰','…‹™‰'),
(*193*) ('’','‚‰','™‰'),
(*194*) ('’‘','‚‰‘','™‰‘'),
(*195*) ('’','‚‰','™‰'),
(*196*) ('’‘','‚‰‘','™‰‘'),
(*197*) ('’','‚‰','™‰'),
(*198*) ('’‘','‚‰‘','™‰‘'),
(*199*) ('‘’','‘‚‰','‡™‰'),
(*200*) ('‘’‘','‘‚‰‘','‡™‰‘'),
(*201*) ('‘’','‘‚‰','‡™‰'),
(*202*) ('‘’‘','‘‚‰‘','‡™‰‘'),
(*203*) ('„’','„‚‰','„™‰'),
(*204*) ('„’‘','„‚‰‘','„™‰‘'),
(*205*) ('‡’','‡‚‰','‡™‰'),
(*206*) ('‡’‘','‡‚‰‘','‡™‰‘'),
(*207*) ('‘’','‘‚‰','‘™‰'),
(*208*) ('‘’‘','‘‚‰‘','‘™‰‘'),
(*209*) ('‘’’','‘’‚‰','‘’™‰'),
(*210*) ('‘’’‘','‘’‚‰‘','‘’™‰‘'),
(*211*) ('’’','’‚‰','’™‰'),
(*212*) ('’’‘','’‚‰‘','’™‰‘'),
(*213*) ('’’','’‚‰','’™‰'),
(*214*) ('’’‘','’‚‰‘','’™‰‘'),
(*215*) ('’','‚‰','™‰'),
(*216*) ('’‘','‚‰‘','™‰‘'),
(*217*) ('„…’','„…‚‰','„™‰'),
(*218*) ('„…’‘','„…‚‰‘','„™‰‘'),
(*219*) ('’…’','’…‚‰','’™‰'),
(*220*) ('’…’‘','’…‚‰‘','’™‰‘'),
(*221*) ('‘’…’','‘’…‚‰','‘’™‰'),
(*222*) ('‘’…’‘','‘’…‚‰‘','‘’™‰‘'),
(*223*) ('‘…’','‘…‚‰','‘™‰'),
(*224*) ('‘…’‘','‘…‚‰‘','‘™‰‘'),
(*225*) ('…’','…‚‰','™‰'),
(*226*) ('…’‘','…‚‰‘','™‰‘'),
(*227*) ('’’','’‚‰','’™‰'),
(*228*) ('’’‘','’‚‰‘','’™‰‘'),
(*229*) ('’','‚‰','™‰'),
(*230*) ('’‘','‚‰‘','™‰‘'),
(*231*) ('’','‚‰','™‰'),
(*232*) ('’‘','‚‰‘','™‰‘'),
(*233*) ('’','‚‰','™‰'),
(*234*) ('’‘','‚‰‘','™‰‘'),
(*235*) ('“’','“‚‰','“™‰'),
(*236*) ('’','‚‰','™‰'),
(*237*) ('’‘','‚‰‘','™‰‘'),
(*238*) ('‘’','‘‚‰','‘™‰'), 
(*239*) ('‘’‘','‘‚‰‘','‘™‰‘'),
(*240*) ('„’','„‚‰','„™‰'),
(*241*) ('„’‘','„‚‰‘','„™‰‘'),
(*242*) ('’','‚‰','γι¨©'),
(*243*) ('’‘','‚‰‘','γι¨©‘'),
(*244*) ('‡’','‡‚‰','‡™‰'),
(*245*) ('‡’‘','‡‚‰‘','‡™‰‘'),
(*246*) ('€’','€‚‰','‹™‰'),
(*247*) ('€’‘','€‚‰‘','‹™‰‘'),
(*248*) ('€’','€‚‰','‹™‰'),
(*249*) ('€’‘','€‚‰‘','‹™‰‘'),
(*250*) ('‘…’','‘…‚‰','‘™‰'),
(*251*) ('—','‰','“™‰'),
(*252*) ('—‘','‰‘','“™‰‘'),
(*253*) ('€’','€‚‰','€™‰'),
(*254*) ('€’‘','€‚‰‘','€™‰‘'),
(*255*) ('','',''),
(*256*) ('’','‰','“™‰'),
(*257*) ('’‘','‰‘','“™‰‘'),
(*258*) ('‘’……’','‘’…‰','‡’“™‰'),
(*259*) ('‘’……’‘','‘’…‰‘','‡’“™‰‘'),
(*260*) ('‘……’','‘…‰','‡“™‰'),
(*261*) ('‘……’‘','‘…‰‘','‡“™‰‘'),
(*262*) ('’€’','’€‚‰','—“™‰'),      
(*263*) ('’€’‘','’€‚‰‘','—“™‰‘'),
(*264*) ('•€’','•€‚‰','“™‰'),      
(*265*) ('•€’‘','‰‘','“™‰‘'),
(*266*) ('„…’','„…‚‰','„™‰'),      
(*267*) ('„…’‘','„…‚‰‘','„‰‘'),  
(*268*) ('€‘’','€‚‰','€„“™‰'),
(*269*) ('‡‘’‹€’‘','‡‘’‹€‚‰‘','‘‘’…‹™‰‘'),
(*270*) ('€’','€‚‰','—“™‰'),      
(*271*) ('€’‘','€‚‰‘','—“™‰‘'),
(*272*) ('’’','’‚‰','’™‰'),      
(*273*) ('’’‘','’‚‰‘','’™‰‘'),
(*274*) ('“’','“‚‰','“™‰'),         
(*275*) ('“’‘','“‚‰‘','“™‰‘'),   
(*276*) ('‘’‹€’‘','‘’‹€‚‰‘','‘’…‹™‰‘'),
(*277*) ('’','‚‰','›“™‰'),      
(*278*) ('’‘','‚‰‘','›“™‰‘'),
(*279*) ('‡‘’‹€’','‡‘’‹€‚‰','‘‘’…‹™‰'),
(*280*) ('‘€’','‘€‚‰','“™‰'),        
(*281*) ('‘€’‘','‘€‚‰‘','“™‰‘'),  
(*282*) ('’','‚‰','‰“™‰'),      
(*283*) ('’‘','‚‰‘','‰“™‰‘'),
(*284*) ('‘’‹€’','‘’‹€‚‰','‘’…‹™‰'),
(*285*) ('’','‚‰','™‰'),
(*286*) ('€’','€‚‰','“™‰'),
(*287*) ('€’‘','€‚‰‘','“™‰‘'),
(*288*) ('“’','“‚‰','“™‰'),
(*289*) ('‰’',' …„‰','‰„“™‰'));

  TYPE
    STR115 = STRING [115];
  VAR
    INP, OUT : TEXT;
    LINE, HEADER : STRING [79];
    L, CLS, L0, L1, P, P1 : INTEGER;
    SYA : BOOLEAN;
    HEAD, TOKEN, TKNOUT : STR115;
    SPCH : CHAR;
    NCH, NHEAD : STRING [1];
    CODE : INTEGER;
    F2 : STRING [2];
    COUNT : LONGINT;

FUNCTION GIVE_IT_2 (TOK:STR115):BOOLEAN;
CONST
T : ARRAY[1..11] OF STR115 =
('€','€','‰–›','‚‰‘€','€‘›…',
'‹','’‚','‘‹„€’›','”€‡','—€‘’2','—€‘’2');
VAR I:BYTE; FOUND:BOOLEAN;
BEGIN
  FOUND:=FALSE;
  I:=0;
  REPEAT
    INC(I);
    FOUND:=(T[I]=TOK);
  UNTIL FOUND OR (I=11);
  GIVE_IT_2:=FOUND;
END;

FUNCTION GIVE_IT_2X (TOK:STR115):BOOLEAN;
CONST
T : ARRAY[1..14] OF STR115 =
('^^‚^','‘‘‹…„‚€’…‹','‘‘‹…„‚€’…‹','’…','’…›',
'€“€','€“€  ’…•€','€“','’€‘‹','’€‘‹',
'ƒ€€2','ƒ€›2','“—…›‰','“—…›…');
VAR I:BYTE; FOUND:BOOLEAN;
BEGIN
  FOUND:=FALSE;
  I:=0;
  REPEAT
    INC(I);
    FOUND:=(T[I]=TOK);
  UNTIL FOUND OR (I=14);
  GIVE_IT_2X:=FOUND;
END;

FUNCTION GIVE_IT_3 (TOK:STR115):BOOLEAN;
CONST
T : ARRAY[1..12] OF STR115 =
('‚›‚„1','‚›‚„›1','‡€‹—……1','…’‚…—‚‘’',
'€‚‹€','€‚‹','’……€','’…',
'”“‹€','”“‹‚€','”“‹‚','”“‹›');
VAR 
  I:BYTE; 
  FOUND:BOOLEAN;
BEGIN
  FOUND:=FALSE;
  I:=0;
  REPEAT
    INC(I);
    FOUND:=(T[I]=TOK);
  UNTIL FOUND OR (I=12);
  GIVE_IT_3:=FOUND;
END;

BEGIN           (* MAIN *)
  ASSIGN (INP, 'SUBJS.COD');
  RESET (INP);
  ASSIGN (OUT, 'PARTS.COD');
  REWRITE (OUT);
  COUNT := 0;

  WRITELN ('FILE SUBJS.COD BEING PROCESSED');
  REPEAT
    READLN (INP, LINE);
    L := LENGTH (LINE);
    IF (LINE [1] = '+')
      THEN
        BEGIN
          HEADER := COPY(LINE, 17, L - 16);
          WRITELN (OUT, '+ 1   0   0 0 ', HEADER);
          P := POS ('<', HEADER);
          IF P > 0
            THEN
              BEGIN
                HEADER := COPY (HEADER, 1, P-1);
                NHEAD := HEADER [P-1];
              END;
        END
      ELSE
        BEGIN
          HEAD := '- 3';
          TOKEN := COPY (LINE, 19, L - 18);
          L0 := LENGTH (TOKEN);
          IF (POS (TOKEN [L0], '123456') > 0)
            THEN
              BEGIN
                NCH := TOKEN [L0];
                TOKEN := COPY (TOKEN, 1, L0-1);
                DEC (L0);
              END
            ELSE NCH := DUMMY;
          F2 := COPY (TOKEN, L0-1, 2);
          SYA := (F2 = '‘') OR (F2 = '‘');

          SPCH := LINE [17];
          VAL (COPY (LINE, 11, 3), CLS, CODE);

          IF POS (BL, TOKEN) = 0
            THEN
              CASE SPCH OF
                '0' :
                  IF (CLS <> 0)
                    THEN
                      BEGIN
                        TKNOUT := TOKEN + NCH;
                        WRITELN (OUT, HEAD, CLS : 4, '255' : 4,
                          '0' : 2, '0' : 2, BL, TKNOUT);
                        INC (COUNT);
                      END;
                '1' :
                  {IF (TOKEN <> '…„/“//‘/—…‘’')
                    (CLS <> 44) AND (CLS <> 45) AND
                    (CLS <> 176) AND (CLS <> 177)
                    THEN}
                  BEGIN
                    TKNOUT := COPY (TOKEN, 1, L0 -
                      LENGTH (CLASSES3 [CLS, 1])) + CLASSES3 [CLS, 2];
                    L1 := LENGTH (TKNOUT);
                    P1 := POS ('‰', TKNOUT);
                    IF (TKNOUT = '‘—…‡‰')
                      OR (TKNOUT = '“•‰')
                      OR (TKNOUT = '†“•‰')
                      OR (TKNOUT = 'ƒ‰')
                      OR (TKNOUT = '„‘‰')
                      OR (TKNOUT = '„›ƒ‰')
                      OR (TKNOUT = '…‰')
                      OR (TKNOUT = '‰')
                      OR (TKNOUT = '…‰')
                      OR (TKNOUT = '‚‡›‰')
                      OR (TKNOUT = '‹…‘‰')
                      OR (TKNOUT = '’•‰')
                      OR (TKNOUT = '“†€‘‰')
                      THEN INSERT ('“‚', TKNOUT, P1)
                    ELSE IF (POS ('‘ƒ‰',TKNOUT) > 0)
                      OR (POS ('‹ƒ‰', TKNOUT) > 0)
                      OR (POS ('“ƒ‰', TKNOUT) > 0)
                      OR (POS ('€ƒ‰', TKNOUT) > 0)
                      OR (POS ('„•‰', TKNOUT) > 0)
                      OR (POS ('•€‰', TKNOUT) > 0)
                      OR (POS ('•‹…‘‰', TKNOUT) > 0)
                      OR (POS ('‘‹€‰', TKNOUT) > 0)
                      THEN INSERT ('“‚', TKNOUT, P1)
                    ELSE IF (TKNOUT = '‚‚‰')
                      THEN INSERT ('“', TKNOUT, P1-1)
                    ELSE IF (TKNOUT = '—…’‰')
                      THEN TKNOUT := '—’€‚‰'
                    ELSE IF (TKNOUT = 'ƒ„‰')
                      THEN TKNOUT := 'ƒ„“™‰'
                    ELSE IF (TKNOUT = '‚‘’“‚‰') 
                      OR (TKNOUT = '’‚…—€‚‰')
                      THEN TKNOUT := TKNOUT + NCH
                    ELSE IF (TKNOUT = '‘€‚‰') OR (TKNOUT = '‚›…„‰')
                      THEN TKNOUT := TKNOUT + '1';
                    IF SYA
                      THEN CLS := 6
                      ELSE CLS := 3;
                    IF HEAD <> 'ƒ„‰' 
                    THEN
                      WRITELN (OUT, HEAD, CLS : 4, '255' : 4,
                        '0' : 2, '0' : 2, BL, TKNOUT);
                    INC (COUNT);
                  END;
                '2' :
                  IF (POS ('„€’', TOKEN) = 0) AND
                    (POS ('‘’’', TOKEN) = 0) AND
                    (POS ('…‘’‘', TOKEN) = 0) AND
                    (POS ('‰’', TOKEN) = 0) AND
                    (POS ('‘’€’', TOKEN) = 0)
                    THEN
                  BEGIN
                    TKNOUT := COPY (TOKEN, 1, L0 -
                      LENGTH (CLASSES3 [CLS, 1])) + CLASSES3 [CLS, 3];
                    IF (TKNOUT = '‚‘’“€™‰') OR (TKNOUT = '’‚…—€™‰')
                      OR (TKNOUT = '’‚…—€‚‰')
                      OR (TKNOUT = '•„™‰') OR (TKNOUT = '‘„…†€™‰')
                      OR (TKNOUT = '…„‘’€‚‹™‰')
                      THEN TKNOUT := TKNOUT + NCH
                    ELSE IF (TKNOUT = '‹…‘’™‰') OR (TKNOUT = '‚…„“™‰')
                      OR (TKNOUT = '„…‰‘’‚“™‰') OR (TKNOUT = '‚›„€™‰‘')
                      OR (TKNOUT = '‡€•‚€’›‚€™‰') OR (TKNOUT = '’…“™‰')
                      OR (TKNOUT = '—€™‰')
                      THEN TKNOUT := TKNOUT + '2'
                    ELSE IF (TKNOUT = 'ƒ™‰') OR (TKNOUT = '•„™‰')
                      OR (TKNOUT = '‘‘’€‚‹™‰') OR (TKNOUT = '‘’™‰')
                      THEN TKNOUT := TKNOUT + '1'
                    ELSE IF (TKNOUT = '€‘’“€™‰')
                      THEN
                        IF GIVE_IT_2 (HEADER)
                          THEN TKNOUT := TKNOUT + '2'
                          ELSE TKNOUT := TKNOUT + '1'
                    ELSE IF (TKNOUT = '…€™‰')
                      THEN
                        IF GIVE_IT_2X (HEADER)
                          THEN TKNOUT := TKNOUT + '2'
                          ELSE TKNOUT := TKNOUT + '1'
                    ELSE IF (TKNOUT = '‘‹…„“™‰')
                      THEN
                        IF GIVE_IT_3 (HEADER)
                          THEN TKNOUT := TKNOUT + '3'
                          ELSE TKNOUT := TKNOUT + '2';
                    IF SYA
                      THEN CLS := 6
                      ELSE CLS := 3;
                    WRITELN (OUT, HEAD, CLS : 4, '255' : 4,
                      '0' : 2, '0' : 2, BL, TKNOUT);
                    INC (COUNT);
                  END;
                '3' : ;
              END;
           END;
  UNTIL EOF (INP);

  FLUSH (OUT);
  WRITELN (COUNT, ' PARTICIPLES IN "PARTS.COD" ');
END.
